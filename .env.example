# =============================================================================
# Neo Service Layer - Environment Configuration
# MarbleRun + EGo + Supabase + Vercel Architecture
# =============================================================================

# =============================================================================
# Supabase Configuration
# =============================================================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
# Supabase service role key. For compatibility:
# - Go services typically use `SUPABASE_SERVICE_KEY`
# - Supabase Edge functions typically use `SUPABASE_SERVICE_ROLE_KEY`
SUPABASE_SERVICE_KEY=your-service-key
SUPABASE_SERVICE_ROLE_KEY=your-service-key

# PostgreSQL Direct Connection (SSL Required)
POSTGRES_HOST=db.your-project.supabase.co
POSTGRES_PORT=5432
POSTGRES_DB=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-password
POSTGRES_SSLMODE=verify-full

# =============================================================================
# MarbleRun Coordinator Configuration
# =============================================================================
# Address marbles use to reach the coordinator mesh port.
# - Docker Compose: use the service DNS name (default network)
# - Kubernetes: use the Service DNS name (e.g. marblerun-coordinator.marblerun.svc.cluster.local:2001)
COORDINATOR_MESH_ADDR=coordinator:2001
COORDINATOR_CLIENT_ADDR=localhost:4433
MANIFEST_PATH=/app/manifests/manifest.json

# =============================================================================
# EGo/SGX Configuration
# =============================================================================
# Set to 1 for simulation mode (development)
# Set to 0 for SGX hardware (production)
OE_SIMULATION=1

# =============================================================================
# Server Configuration
# =============================================================================
MARBLE_ENV=development
PORT=8080
METRICS_PORT=9090
DEBUG=false

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# =============================================================================
# Secrets (Shared: Supabase Edge + TEE services)
# =============================================================================
# Secrets encryption master key (hex-encoded 32 bytes).
# Required for secrets management and secret injection into services.
# Generate with `openssl rand -hex 32`
SECRETS_MASTER_KEY=

# =============================================================================
# Neo N3 Configuration
# =============================================================================
NEO_RPC_URL=https://testnet1.neo.coz.io:443
NEO_NETWORK_MAGIC=894710606

# Neo N3 Testnet Account (for Fairy tests and contract deployment)
NEO_TESTNET_WIF=your-testnet-wif-here
NEO_TESTNET_ADDRESS=your-testnet-address-here
NEO_TESTNET_PUBKEY=your-testnet-pubkey-here

# =============================================================================
# Neo N3 Contract Addresses
# Deploy contracts with: go run ./cmd/deploy-fairy/main.go
# =============================================================================
# MiniApp platform contracts
CONTRACT_PAYMENTHUB_HASH=0x0000000000000000000000000000000000000000
CONTRACT_GOVERNANCE_HASH=0x0000000000000000000000000000000000000000
CONTRACT_PRICEFEED_HASH=0x0000000000000000000000000000000000000000
CONTRACT_RANDOMNESSLOG_HASH=0x0000000000000000000000000000000000000000
CONTRACT_APPREGISTRY_HASH=0x0000000000000000000000000000000000000000
CONTRACT_AUTOMATIONANCHOR_HASH=0x0000000000000000000000000000000000000000

# Fairy RPC for local testing
FAIRY_RPC_URL=http://127.0.0.1:16868

# =============================================================================
# Supabase Edge (Gateway) -> TEE service routing (configured in Supabase)
# =============================================================================
# These are the service URLs the Edge functions call. In production you should
# use HTTPS + mTLS with MarbleRun/attested TLS.
NEOFEEDS_URL=http://neofeeds:8083
NEOCOMPUTE_URL=http://neocompute:8086
NEOORACLE_URL=http://neooracle:8088
TXPROXY_URL=http://txproxy:8090

# Oracle outbound URL allowlist (comma-separated prefixes)
# Required in production/SGX mode. Examples:
# ORACLE_HTTP_ALLOWLIST=https://api.binance.com,https://api.coinbase.com
ORACLE_HTTP_ALLOWLIST=https://api.binance.com,https://api.coinbase.com

# TxProxy allowlist (JSON). Default is deny-all when unset.
# TXPROXY_ALLOWLIST='{"contracts":{"<contractHash>":["MethodA","MethodB"]}}'
TXPROXY_ALLOWLIST=

# NeoFlow webhook security (production/SGX)
# External webhooks are blocked from targeting private/loopback/link-local networks by default.
# Set to true only if you need to call private endpoints (not recommended).
NEOFLOW_WEBHOOK_ALLOW_PRIVATE_NETWORKS=false

# AutomationAnchor anchored tasks (optional)
# Comma-separated task IDs to load from the on-chain `AutomationAnchor` registry.
# Each entry can be either:
# - plain ASCII (stored as bytes), or
# - hex bytes (0x...).
NEOFLOW_TASK_IDS=

# Binance API
BINANCE_API_KEY=your_binance_api_key_here

# Arbitrum RPC for Chainlink price feeds
ARBITRUM_RPC=https://arb1.arbitrum.io/rpc

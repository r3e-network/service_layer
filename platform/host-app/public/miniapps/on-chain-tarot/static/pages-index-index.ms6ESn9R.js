import{r as a,d as e,c as n,a as t,w as s,i as r,o as l,b as i,e as o,f as c,g as u,n as d,t as m,h as p,F as f,j as v,k as w,u as h}from"./index-CYsq6bLj.js";function y(a=5e3){return new Promise((e,n)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const t=setTimeout(()=>{n(new Error("SDK timeout"))},a),s=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):n(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}const _="miniapp-onchaintarot",g=((a,e)=>{const n=a.__vccOpts||a;for(const[t,s]of e)n[t]=s;return n})(e({__name:"index",setup(e){const{payGAS:g,isLoading:T}=function(e){const n=a(!1),t=a(null);return{isLoading:n,error:t,payGAS:async(a,s)=>{n.value=!0,t.value=null;try{const n=await y();return await n.payments.payGAS(e,a,s)}catch(r){throw t.value=r,r}finally{n.value=!1}}}}(_),{requestRandom:k}=function(e){const n=a(!1),t=a(null);return{isLoading:n,error:t,requestRandom:async()=>{n.value=!0,t.value=null;try{const a=await y();return await a.rng.requestRandom(e)}catch(a){throw t.value=a,a}finally{n.value=!1}}}}(_),D=[{name:"The Fool",icon:"ðŸƒ"},{name:"The Magician",icon:"ðŸŽ©"},{name:"The High Priestess",icon:"ðŸ”®"},{name:"The Empress",icon:"ðŸ‘‘"},{name:"The Emperor",icon:"âš”ï¸"},{name:"The Lovers",icon:"ðŸ’•"},{name:"The Chariot",icon:"ðŸ‡"},{name:"Strength",icon:"ðŸ¦"},{name:"The Hermit",icon:"ðŸ•¯ï¸"},{name:"Wheel of Fortune",icon:"â˜¸ï¸"},{name:"Justice",icon:"âš–ï¸"},{name:"The Hanged Man",icon:"ðŸ™ƒ"},{name:"Death",icon:"ðŸ’€"},{name:"Temperance",icon:"ðŸ·"},{name:"The Devil",icon:"ðŸ˜ˆ"},{name:"The Tower",icon:"ðŸ—¼"},{name:"The Star",icon:"â­"},{name:"The Moon",icon:"ðŸŒ™"},{name:"The Sun",icon:"â˜€ï¸"},{name:"Judgement",icon:"ðŸ“¯"},{name:"The World",icon:"ðŸŒ"}],S=a([]),A=a(null),C=n(()=>3===S.value.length),b=n(()=>S.value.every(a=>a.flipped)),E=async()=>{if(!T.value)try{A.value={msg:"Drawing cards...",type:"loading"},await g("2",`draw:${Date.now()}`);const a=await k(`tarot:${Date.now()}`),e=[a%22,7*a%22,13*a%22];S.value=e.map(a=>({...D[a],flipped:!1})),A.value={msg:"Cards drawn!",type:"success"}}catch(a){A.value={msg:a.message||"Error",type:"error"}}},M=()=>{S.value=[],A.value=null};return(a,e)=>{const n=c,y=r;return l(),t(y,{class:"app-container"},{default:s(()=>[i(y,{class:"header"},{default:s(()=>[i(n,{class:"title"},{default:s(()=>[u("On-Chain Tarot")]),_:1}),i(n,{class:"subtitle"},{default:s(()=>[u("Blockchain-powered divination")]),_:1})]),_:1}),A.value?(l(),t(y,{key:0,class:d(["status-msg",A.value.type])},{default:s(()=>[i(n,null,{default:s(()=>[u(m(A.value.msg),1)]),_:1})]),_:1},8,["class"])):o("",!0),i(y,{class:"card"},{default:s(()=>[i(n,{class:"card-title"},{default:s(()=>[u("Draw Your Cards")]),_:1}),i(y,{class:"cards-row"},{default:s(()=>[(l(!0),p(f,null,v(S.value,(a,e)=>(l(),t(y,{key:e,class:"tarot-card",onClick:a=>{return n=e,void(S.value[n]&&(S.value[n].flipped=!0));var n}},{default:s(()=>[a.flipped?(l(),t(n,{key:0,class:"card-face"},{default:s(()=>[u(m(a.icon),1)]),_:2},1024)):(l(),t(y,{key:1,class:"card-back"},{default:s(()=>[i(n,{class:"card-pattern"},{default:s(()=>[u("ðŸŒ™")]),_:1})]),_:1})),a.flipped?(l(),t(n,{key:2,class:"card-name"},{default:s(()=>[u(m(a.name),1)]),_:2},1024)):o("",!0)]),_:2},1032,["onClick"]))),128))]),_:1}),C.value?(l(),t(y,{key:1,class:"reset-btn",onClick:M},{default:s(()=>[i(n,null,{default:s(()=>[u("Draw Again")]),_:1})]),_:1})):(l(),t(y,{key:0,class:"draw-btn",onClick:E,style:w({opacity:h(T)?.6:1})},{default:s(()=>[i(n,null,{default:s(()=>[u(m(h(T)?"Drawing...":"Draw 3 Cards (2 GAS)"),1)]),_:1})]),_:1},8,["style"]))]),_:1}),C.value&&b.value?(l(),t(y,{key:1,class:"card"},{default:s(()=>[i(n,{class:"card-title"},{default:s(()=>[u("Your Reading")]),_:1}),i(n,{class:"reading-text"},{default:s(()=>[u(m("Your past shows transformation, present reveals balance, and future promises new beginnings. Trust the journey ahead."),1)]),_:1})]),_:1})):o("",!0)]),_:1})}}}),[["__scopeId","data-v-bd1fa6a4"]]);export{g as default};

import{r as e,d as a,c as l,w as u,i as t,a as s,o,b as n,e as d,f as r,g as c,n as i,t as p,u as v}from"./index-JX46pkDj.js";function f(a){const l=e(!1),u=e(null);return{isLoading:l,error:u,payGAS:async(e,t)=>{l.value=!0,u.value=null;try{const l=await function(e=5e3){return new Promise((a,l)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const u=setTimeout(()=>{l(new Error("SDK timeout"))},e),t=()=>{clearTimeout(u),window.removeEventListener("miniapp-sdk-ready",t),window.MiniAppSDK?a(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",t)})}();return await l.payments.payGAS(a,e,t)}catch(s){throw u.value=s,s}finally{l.value=!1}}}}const _="0.050",m=((e,a)=>{const l=e.__vccOpts||e;for(const[u,t]of a)l[u]=t;return l})(a({__name:"index",setup(a){const{payGAS:m,isLoading:y}=f("miniapp-dark-pool"),w=e({volume24h:85e4,avgBlockSize:5e3,privacyLevel:"High (ZK)"}),S=e("Buy"),g=e(""),A=e("0.5"),k=e(null),h=(e,a=2)=>function(e,a=2){return e>=1e6?(e/1e6).toFixed(a)+"M":e>=1e3?(e/1e3).toFixed(a)+"K":e.toFixed(a)}(e,a),G=async()=>{if(y.value)return;const e=parseFloat(g.value),a=parseFloat(A.value);if(e>=1e3&&a>0&&a<=5)try{await m(_,`darkpool:${S.value}:${e}:${a}`),k.value={msg:`Dark order placed: ${S.value} ${e} GAS`,type:"success"}}catch(l){k.value={msg:(null==l?void 0:l.message)||"Payment failed",type:"error"}}else k.value={msg:"Min 1000 GAS, slippage 0-5%",type:"error"}};return(e,a)=>{const f=r,m=t,D=s("uni-easyinput");return o(),l(m,{class:"app-container"},{default:u(()=>[n(m,{class:"header"},{default:u(()=>[n(f,{class:"title"},{default:u(()=>[c("Dark Pool")]),_:1}),n(f,{class:"subtitle"},{default:u(()=>[c("Anonymous large-block trading")]),_:1})]),_:1}),k.value?(o(),l(m,{key:0,class:i(["status-msg",k.value.type])},{default:u(()=>[n(f,null,{default:u(()=>[c(p(k.value.msg),1)]),_:1})]),_:1},8,["class"])):d("",!0),n(m,{class:"card"},{default:u(()=>[n(f,{class:"card-title"},{default:u(()=>[c("Pool Stats")]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("24h volume")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(h(w.value.volume24h,0))+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("Avg. block size")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(h(w.value.avgBlockSize,0))+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("Privacy level")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(w.value.privacyLevel),1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:u(()=>[n(f,{class:"card-title"},{default:u(()=>[c("Your Order")]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("Type")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(S.value||"Buy"),1)]),_:1})]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("Amount")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(g.value||"0")+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:u(()=>[n(f,null,{default:u(()=>[c("Slippage")]),_:1}),n(f,{class:"v"},{default:u(()=>[c(p(A.value||"0.5")+"%",1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:u(()=>[n(f,{class:"card-title"},{default:u(()=>[c("Place Order")]),_:1}),n(D,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),placeholder:"Type (Buy/Sell)"},null,8,["modelValue"]),n(D,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=e=>g.value=e),type:"number",placeholder:"Amount (min 1000 GAS)"},null,8,["modelValue"]),n(D,{modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=e=>A.value=e),type:"number",placeholder:"Max slippage %"},null,8,["modelValue"]),n(m,{class:"action-btn",onClick:G},{default:u(()=>[n(f,null,{default:u(()=>[c(p(v(y)?"Processing...":"Place Dark Order"),1)]),_:1})]),_:1}),n(f,{class:"note"},{default:u(()=>[c("Mock privacy fee: "+p(_)+" GAS")]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-00252592"]]);export{m as default};

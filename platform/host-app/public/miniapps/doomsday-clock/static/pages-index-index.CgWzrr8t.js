import{r as a,d as e,o as t,a as s,c as l,w as u,i as o,b as n,e as d,f as c,g as r,h as i,j as p,n as v,t as f,k as m,l as _,F as y,m as k,u as g}from"./index-D1K0CknT.js";function S(e){const t=a(!1),s=a(null);return{isLoading:t,error:s,payGAS:async(a,l)=>{t.value=!0,s.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const s=setTimeout(()=>{t(new Error("SDK timeout"))},a),l=()=>{clearTimeout(s),window.removeEventListener("miniapp-sdk-ready",l),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",l)})}();return await t.payments.payGAS(e,a,l)}catch(u){throw s.value=u,u}finally{t.value=!1}}}}const w=((a,e)=>{const t=a.__vccOpts||a;for(const[s,l]of e)t[s]=l;return t})(e({__name:"index",setup(e){const{payGAS:w,isLoading:b}=S("miniapp-doomsday-clock"),h=a("5"),x=a(25e3),A=a(50),E=a(142),D=a("05:23:45"),F=a(65),K=a(null),P=a(null),I=a([{name:"Protocol Upgrade",odds:2.5},{name:"Treasury Release",odds:3},{name:"Governance Vote",odds:1.8}]),M=a([{date:"2025-12-20",description:"Emergency Proposal",result:"Passed"},{date:"2025-12-15",description:"Fee Adjustment",result:"Failed"}]),T=a=>function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,0),G=async()=>{if(b.value||null===K.value)return void(P.value={msg:"Select an outcome",type:"error"});const a=parseFloat(h.value);if(a<1)P.value={msg:"Min stake: 1 GAS",type:"error"};else try{P.value={msg:"Placing stake...",type:"loading"},await w(h.value,`stake:${K.value}`),A.value+=a,x.value+=a,P.value={msg:"Stake placed!",type:"success"}}catch(e){P.value={msg:e.message||"Error",type:"error"}}};let C;return t(()=>{C=setInterval(()=>{const a=D.value.split(":");let e=parseInt(a[0]),t=parseInt(a[1]),s=parseInt(a[2]);s>0?s--:t>0?(t--,s=59):e>0&&(e--,t=59,s=59),D.value=`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`},1e3)}),s(()=>clearInterval(C)),(a,e)=>{const t=i,s=o,S=n("uni-easyinput");return d(),l(s,{class:"app-container"},{default:u(()=>[c(s,{class:"header"},{default:u(()=>[c(t,{class:"title"},{default:u(()=>[p("Doomsday Clock")]),_:1}),c(t,{class:"subtitle"},{default:u(()=>[p("Time-locked governance events")]),_:1})]),_:1}),P.value?(d(),l(s,{key:0,class:v(["status-msg",P.value.type])},{default:u(()=>[c(t,null,{default:u(()=>[p(f(P.value.msg),1)]),_:1})]),_:1},8,["class"])):r("",!0),c(s,{class:"card clock-card"},{default:u(()=>[c(t,{class:"clock-label"},{default:u(()=>[p("Time Until Event")]),_:1}),c(t,{class:"clock-time"},{default:u(()=>[p(f(D.value),1)]),_:1}),c(s,{class:"clock-progress"},{default:u(()=>[c(s,{class:"progress-bar",style:m({width:F.value+"%"})},null,8,["style"])]),_:1})]),_:1}),c(s,{class:"card"},{default:u(()=>[c(s,{class:"stats-grid"},{default:u(()=>[c(s,{class:"stat-box"},{default:u(()=>[c(t,{class:"stat-value"},{default:u(()=>[p(f(T(x.value)),1)]),_:1}),c(t,{class:"stat-label"},{default:u(()=>[p("Total Staked")]),_:1})]),_:1}),c(s,{class:"stat-box"},{default:u(()=>[c(t,{class:"stat-value"},{default:u(()=>[p(f(T(A.value)),1)]),_:1}),c(t,{class:"stat-label"},{default:u(()=>[p("Your Stake")]),_:1})]),_:1}),c(s,{class:"stat-box"},{default:u(()=>[c(t,{class:"stat-value"},{default:u(()=>[p(f(E.value),1)]),_:1}),c(t,{class:"stat-label"},{default:u(()=>[p("Players")]),_:1})]),_:1})]),_:1})]),_:1}),c(s,{class:"card"},{default:u(()=>[c(t,{class:"card-title"},{default:u(()=>[p("Stake on Outcome")]),_:1}),c(S,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=a=>h.value=a),type:"number",placeholder:"Amount to stake"},null,8,["modelValue"]),c(s,{class:"outcomes-list"},{default:u(()=>[(d(!0),_(y,null,k(I.value,(a,e)=>(d(),l(s,{key:e,class:v(["outcome-btn",K.value===e&&"active"]),onClick:a=>K.value=e},{default:u(()=>[c(t,{class:"outcome-name"},{default:u(()=>[p(f(a.name),1)]),_:2},1024),c(t,{class:"outcome-odds"},{default:u(()=>[p(f(a.odds)+"x",1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),c(s,{class:"stake-btn",onClick:G,style:m({opacity:g(b)?.6:1})},{default:u(()=>[c(t,null,{default:u(()=>[p(f(g(b)?"Staking...":"Place Stake"),1)]),_:1})]),_:1},8,["style"])]),_:1}),c(s,{class:"card"},{default:u(()=>[c(t,{class:"card-title"},{default:u(()=>[p("Event History")]),_:1}),c(s,{class:"history-list"},{default:u(()=>[(d(!0),_(y,null,k(M.value,(a,e)=>(d(),l(s,{key:e,class:"history-item"},{default:u(()=>[c(t,{class:"history-date"},{default:u(()=>[p(f(a.date),1)]),_:2},1024),c(t,{class:"history-desc"},{default:u(()=>[p(f(a.description),1)]),_:2},1024),c(t,{class:"history-result"},{default:u(()=>[p(f(a.result),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-164511d6"]]);export{w as default};

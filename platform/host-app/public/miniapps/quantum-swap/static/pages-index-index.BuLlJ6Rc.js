import{r as a,d as e,c as t,w as l,i as s,a as u,o,b as n,e as r,f as i,g as d,n as c,t as f,u as v}from"./index-Bs-lTj4S.js";function p(e){const t=a(!1),l=a(null);return{isLoading:t,error:l,payGAS:async(a,s)=>{t.value=!0,l.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const l=setTimeout(()=>{t(new Error("SDK timeout"))},a),s=()=>{clearTimeout(l),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await t.payments.payGAS(e,a,s)}catch(u){throw l.value=u,u}finally{t.value=!1}}}}const m=((a,e)=>{const t=a.__vccOpts||a;for(const[l,s]of e)t[l]=s;return t})(e({__name:"index",setup(e){const{payGAS:m,isLoading:_}=p("miniapp-quantum-swap"),w=a({fromChain:"Neo N3",fromToken:"GAS",toChain:"Ethereum",toToken:"ETH",rate:42e-5}),y=a({timeLock:"24 hours"}),k=a(""),S=a(null),T=(a,e=2)=>function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,e),h=async()=>{if(_.value)return;const a=parseFloat(k.value);if(!(a>0))return void(S.value={msg:"Enter valid amount",type:"error"});const e=(.003*a).toFixed(4);try{await m(e,`qswap:${w.value.fromChain}:${w.value.toChain}:${a}`);const t=T(a*w.value.rate,4);S.value={msg:`Swap initiated: ${T(a,2)} ${w.value.fromToken} â†’ ${t} ${w.value.toToken}`,type:"success"}}catch(t){S.value={msg:(null==t?void 0:t.message)||"Payment failed",type:"error"}}};return(a,e)=>{const p=i,m=s,g=u("uni-easyinput");return o(),t(m,{class:"app-container"},{default:l(()=>[n(m,{class:"header"},{default:l(()=>[n(p,{class:"title"},{default:l(()=>[d("Quantum Swap")]),_:1}),n(p,{class:"subtitle"},{default:l(()=>[d("Atomic cross-chain swaps")]),_:1})]),_:1}),S.value?(o(),t(m,{key:0,class:c(["status-msg",S.value.type])},{default:l(()=>[n(p,null,{default:l(()=>[d(f(S.value.msg),1)]),_:1})]),_:1},8,["class"])):r("",!0),n(m,{class:"card"},{default:l(()=>[n(p,{class:"card-title"},{default:l(()=>[d("Swap Route")]),_:1}),n(m,{class:"row"},{default:l(()=>[n(p,null,{default:l(()=>[d("From")]),_:1}),n(p,{class:"v"},{default:l(()=>[d(f(w.value.fromChain)+" / "+f(w.value.fromToken),1)]),_:1})]),_:1}),n(m,{class:"row"},{default:l(()=>[n(p,null,{default:l(()=>[d("To")]),_:1}),n(p,{class:"v"},{default:l(()=>[d(f(w.value.toChain)+" / "+f(w.value.toToken),1)]),_:1})]),_:1}),n(m,{class:"row"},{default:l(()=>[n(p,null,{default:l(()=>[d("Rate")]),_:1}),n(p,{class:"v"},{default:l(()=>[d("1 "+f(w.value.fromToken)+" = "+f(w.value.rate)+" "+f(w.value.toToken),1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:l(()=>[n(p,{class:"card-title"},{default:l(()=>[d("Swap Details")]),_:1}),n(g,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),type:"number",placeholder:"Amount to swap"},null,8,["modelValue"]),n(m,{class:"detail-row"},{default:l(()=>[n(p,null,{default:l(()=>[d("You receive")]),_:1}),n(p,{class:"receive"},{default:l(()=>[d(f(T(parseFloat(k.value||"0")*w.value.rate,4))+" "+f(w.value.toToken),1)]),_:1})]),_:1}),n(m,{class:"detail-row"},{default:l(()=>[n(p,null,{default:l(()=>[d("Bridge fee (0.3%)")]),_:1}),n(p,{class:"fee"},{default:l(()=>[d(f((.003*parseFloat(k.value||"0")).toFixed(4))+" "+f(w.value.fromToken),1)]),_:1})]),_:1}),n(m,{class:"detail-row"},{default:l(()=>[n(p,null,{default:l(()=>[d("Time lock")]),_:1}),n(p,{class:"lock"},{default:l(()=>[d(f(y.value.timeLock),1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:l(()=>[n(p,{class:"card-title"},{default:l(()=>[d("Initiate Swap")]),_:1}),n(m,{class:"action-btn",onClick:h},{default:l(()=>[n(p,null,{default:l(()=>[d(f(v(_)?"Processing...":"Start Atomic Swap"),1)]),_:1})]),_:1}),n(p,{class:"note"},{default:l(()=>[d("Trustless cross-chain exchange via HTLC")]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-ca9e43e1"]]);export{m as default};

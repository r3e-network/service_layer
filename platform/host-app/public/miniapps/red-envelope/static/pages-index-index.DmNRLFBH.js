import{r as e,d as a,c as l,w as n,i as t,a as s,o,b as u,e as i,f as r,g as d,n as c,t as p,u as m,h as f,F as v,j as _}from"./index-ByqWDDQG.js";function y(a){const l=e(!1),n=e(null);return{isLoading:l,error:n,payGAS:async(e,t)=>{l.value=!0,n.value=null;try{const l=await function(e=5e3){return new Promise((a,l)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const n=setTimeout(()=>{l(new Error("SDK timeout"))},e),t=()=>{clearTimeout(n),window.removeEventListener("miniapp-sdk-ready",t),window.MiniAppSDK?a(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",t)})}();return await l.payments.payGAS(a,e,t)}catch(s){throw n.value=s,s}finally{l.value=!1}}}}const w=((e,a)=>{const l=e.__vccOpts||e;for(const[n,t]of a)l[n]=t;return l})(a({__name:"index",setup(a){const{payGAS:w,isLoading:g}=y("miniapp-redenvelope"),S=e(""),k=e(""),E=e(null),A=e([{id:"1",from:"NX8...abc",remaining:3,total:5,amount:10},{id:"2",from:"NY2...def",remaining:1,total:3,amount:5}]),b=async()=>{if(!g.value)try{await w(S.value,`redenvelope:${k.value}`),E.value={msg:"Envelope sent!",type:"success"}}catch(e){E.value={msg:e.message||"Error",type:"error"}}};return(e,a)=>{const y=r,w=t,h=s("uni-easyinput");return o(),l(w,{class:"app-container"},{default:n(()=>[u(w,{class:"header"},{default:n(()=>[u(y,{class:"title"},{default:n(()=>[d("Red Envelope")]),_:1}),u(y,{class:"subtitle"},{default:n(()=>[d("Lucky red packets")]),_:1})]),_:1}),E.value?(o(),l(w,{key:0,class:c(["status-msg",E.value.type])},{default:n(()=>[u(y,null,{default:n(()=>[d(p(E.value.msg),1)]),_:1})]),_:1},8,["class"])):i("",!0),u(w,{class:"card"},{default:n(()=>[u(y,{class:"card-title"},{default:n(()=>[d("Create Envelope")]),_:1}),u(h,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),type:"number",placeholder:"Total GAS"},null,8,["modelValue"]),u(h,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value=e),type:"number",placeholder:"Number of packets"},null,8,["modelValue"]),u(w,{class:"action-btn",onClick:b},{default:n(()=>[u(y,null,{default:n(()=>[d(p(m(g)?"Creating...":"Send Red Envelope"),1)]),_:1})]),_:1})]),_:1}),u(w,{class:"card"},{default:n(()=>[u(y,{class:"card-title"},{default:n(()=>[d("Available Envelopes")]),_:1}),(o(!0),f(v,null,_(A.value,e=>(o(),l(w,{key:e.id,class:"envelope-item",onClick:a=>(async e=>{E.value={msg:`Claimed from ${e.from}!`,type:"success"},e.remaining--})(e)},{default:n(()=>[u(y,{class:"envelope-icon"},{default:n(()=>[d("ðŸ§§")]),_:1}),u(w,{class:"envelope-info"},{default:n(()=>[u(y,{class:"envelope-from"},{default:n(()=>[d("From "+p(e.from),1)]),_:2},1024),u(y,{class:"envelope-remaining"},{default:n(()=>[d(p(e.remaining)+"/"+p(e.total)+" left",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-70a5a1c3"]]);export{w as default};

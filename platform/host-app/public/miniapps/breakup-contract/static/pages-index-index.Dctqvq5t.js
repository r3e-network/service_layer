import{r as a,d as e,c as t,w as s,i as l,a as r,o as n,b as u,e as c,f as o,g as d,n as i,t as p,u as f,h as m,F as v,j as y,k as _}from"./index-C-lhCuQ1.js";function w(e){const t=a(!1),s=a(null);return{isLoading:t,error:s,payGAS:async(a,l)=>{t.value=!0,s.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const s=setTimeout(()=>{t(new Error("SDK timeout"))},a),l=()=>{clearTimeout(s),window.removeEventListener("miniapp-sdk-ready",l),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",l)})}();return await t.payments.payGAS(e,a,l)}catch(r){throw s.value=r,r}finally{t.value=!1}}}}const g=((a,e)=>{const t=a.__vccOpts||a;for(const[s,l]of e)t[s]=l;return t})(e({__name:"index",setup(e){const{payGAS:g,isLoading:k}=w("miniapp-breakupcontract"),C=a(""),S=a(""),h=a(""),A=a(null),b=a([{id:"1",partner:"NX8...abc",stake:"10",progress:65,daysLeft:105},{id:"2",partner:"NY2...def",stake:"5",progress:30,daysLeft:210}]),V=async()=>{if(C.value&&S.value&&!k.value)try{await g(S.value,`contract:${C.value.slice(0,10)}`),A.value={msg:"Contract created!",type:"success"},C.value="",S.value="",h.value=""}catch(a){A.value={msg:a.message||"Error",type:"error"}}};return(a,e)=>{const w=o,g=l,D=r("uni-easyinput");return n(),t(g,{class:"app-container"},{default:s(()=>[u(g,{class:"header"},{default:s(()=>[u(w,{class:"title"},{default:s(()=>[d("Breakup Contract")]),_:1}),u(w,{class:"subtitle"},{default:s(()=>[d("Relationship stakes")]),_:1})]),_:1}),A.value?(n(),t(g,{key:0,class:i(["status-msg",A.value.type])},{default:s(()=>[u(w,null,{default:s(()=>[d(p(A.value.msg),1)]),_:1})]),_:1},8,["class"])):c("",!0),u(g,{class:"card"},{default:s(()=>[u(w,{class:"card-title"},{default:s(()=>[d("Create Contract")]),_:1}),u(D,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=a=>C.value=a),placeholder:"Partner's address"},null,8,["modelValue"]),u(D,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=a=>S.value=a),type:"number",placeholder:"Stake amount (GAS)"},null,8,["modelValue"]),u(D,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),type:"number",placeholder:"Duration (days)"},null,8,["modelValue"]),u(g,{class:"action-btn",onClick:V},{default:s(()=>[u(w,null,{default:s(()=>[d(p(f(k)?"Creating...":"Create Contract"),1)]),_:1})]),_:1})]),_:1}),u(g,{class:"card"},{default:s(()=>[u(w,{class:"card-title"},{default:s(()=>[d("Active Contracts")]),_:1}),(n(!0),m(v,null,y(b.value,a=>(n(),t(g,{key:a.id,class:"contract-item"},{default:s(()=>[u(g,{class:"contract-header"},{default:s(()=>[u(w,{class:"contract-partner"},{default:s(()=>[d(p(a.partner),1)]),_:2},1024),u(w,{class:"contract-stake"},{default:s(()=>[d(p(a.stake)+" GAS",1)]),_:2},1024)]),_:2},1024),u(g,{class:"contract-progress"},{default:s(()=>[u(g,{class:"progress-bar",style:_({width:a.progress+"%"})},null,8,["style"])]),_:2},1024),u(g,{class:"contract-footer"},{default:s(()=>[u(w,{class:"contract-days"},{default:s(()=>[d(p(a.daysLeft)+" days left",1)]),_:2},1024),u(g,{class:"contract-btn",onClick:e=>(async a=>{a.progress<100?A.value={msg:"Contract not completed yet!",type:"error"}:A.value={msg:`Claimed ${a.stake} GAS!`,type:"success"}})(a)},{default:s(()=>[u(w,null,{default:s(()=>[d("Claim")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-bc5f1738"]]);export{g as default};

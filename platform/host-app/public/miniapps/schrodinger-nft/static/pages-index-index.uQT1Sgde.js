import{r as e,d as a,c as s,w as t,i as n,o as r,a as l,b as i,e as o,f as c,n as d,t as u,g as y,F as m,h as f,j as v,u as p}from"./index-gHRUMKYq.js";function w(e=5e3){return new Promise((a,s)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const t=setTimeout(()=>{s(new Error("SDK timeout"))},e),n=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",n),window.MiniAppSDK?a(window.MiniAppSDK):s(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",n)})}const _="miniapp-schrodingernft",g=((e,a)=>{const s=e.__vccOpts||e;for(const[t,n]of a)s[t]=n;return s})(a({__name:"index",setup(a){const{payGAS:g,isLoading:h}=function(a){const s=e(!1),t=e(null);return{isLoading:s,error:t,payGAS:async(e,n)=>{s.value=!0,t.value=null;try{const s=await w();return await s.payments.payGAS(a,e,n)}catch(r){throw t.value=r,r}finally{s.value=!1}}}}(_),{requestRandom:x}=function(a){const s=e(!1),t=e(null);return{isLoading:s,error:t,requestRandom:async()=>{s.value=!0,t.value=null;try{const e=await w();return await e.rng.requestRandom(a)}catch(e){throw t.value=e,e}finally{s.value=!1}}}}(_),b=e([{id:"1",rarity:"Common",revealed:!1},{id:"2",rarity:"Rare",revealed:!1}]),S=e(null),k=e([{icon:"ðŸ‰",name:"Legendary Dragon",chance:5},{icon:"âš”ï¸",name:"Epic Sword",chance:15},{icon:"ðŸ’Ž",name:"Rare Gem",chance:30},{icon:"ðŸª™",name:"Common Coin",chance:50}]),M=async()=>{if(!h.value)try{S.value={msg:"Minting box...",type:"loading"},await g("5",`mint:${Date.now()}`),b.value.push({id:Date.now().toString(),rarity:Math.random()>.7?"Rare":"Common",revealed:!1}),S.value={msg:"Box minted!",type:"success"}}catch(e){S.value={msg:e.message||"Error",type:"error"}}};return(e,a)=>{const w=o,_=n;return r(),s(_,{class:"app-container"},{default:t(()=>[l(_,{class:"header"},{default:t(()=>[l(w,{class:"title"},{default:t(()=>[c("Schrodinger NFT")]),_:1}),l(w,{class:"subtitle"},{default:t(()=>[c("Mystery boxes until revealed")]),_:1})]),_:1}),S.value?(r(),s(_,{key:0,class:d(["status-msg",S.value.type])},{default:t(()=>[l(w,null,{default:t(()=>[c(u(S.value.msg),1)]),_:1})]),_:1},8,["class"])):i("",!0),l(_,{class:"card"},{default:t(()=>[l(w,{class:"card-title"},{default:t(()=>[c("Mystery Boxes")]),_:1}),l(_,{class:"boxes-grid"},{default:t(()=>[(r(!0),y(m,null,f(b.value,e=>(r(),s(_,{key:e.id,class:"mystery-box",onClick:a=>(async e=>{if(!e.revealed)try{S.value={msg:"Revealing...",type:"loading"};const a=await x(`reveal:${e.id}`)%100+1;e.content=a<=5?"ðŸ‰":a<=20?"âš”ï¸":a<=50?"ðŸ’Ž":"ðŸª™",e.revealed=!0,S.value={msg:"Revealed!",type:"success"}}catch(a){S.value={msg:a.message||"Error",type:"error"}}})(e)},{default:t(()=>[e.revealed?(r(),s(w,{key:0,class:"box-revealed"},{default:t(()=>[c(u(e.content),1)]),_:2},1024)):(r(),s(_,{key:1,class:"box-mystery"},{default:t(()=>[l(w,{class:"box-icon"},{default:t(()=>[c("ðŸ“¦")]),_:1}),l(w,{class:"box-rarity"},{default:t(()=>[c(u(e.rarity),1)]),_:2},1024)]),_:2},1024))]),_:2},1032,["onClick"]))),128))]),_:1}),l(_,{class:"buy-btn",onClick:M,style:v({opacity:p(h)?.6:1})},{default:t(()=>[l(w,null,{default:t(()=>[c(u(p(h)?"Minting...":"Buy Mystery Box (5 GAS)"),1)]),_:1})]),_:1},8,["style"])]),_:1}),l(_,{class:"card"},{default:t(()=>[l(w,{class:"card-title"},{default:t(()=>[c("Possible Rewards")]),_:1}),l(_,{class:"rewards-list"},{default:t(()=>[(r(!0),y(m,null,f(k.value,(e,a)=>(r(),s(_,{key:a,class:"reward-item"},{default:t(()=>[l(w,{class:"reward-icon"},{default:t(()=>[c(u(e.icon),1)]),_:2},1024),l(w,{class:"reward-name"},{default:t(()=>[c(u(e.name),1)]),_:2},1024),l(w,{class:"reward-chance"},{default:t(()=>[c(u(e.chance)+"%",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-0e2ca12a"]]);export{g as default};

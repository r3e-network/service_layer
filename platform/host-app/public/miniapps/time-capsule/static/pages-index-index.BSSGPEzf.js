import{r as e,d as a,c as l,w as t,i as s,a as n,o as u,b as c,e as d,f as o,g as i,n as r,t as p,h as m,F as f,j as y,k as v,u as _}from"./index-PTBNQDAs.js";function k(a){const l=e(!1),t=e(null);return{isLoading:l,error:t,payGAS:async(e,s)=>{l.value=!0,t.value=null;try{const l=await function(e=5e3){return new Promise((a,l)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const t=setTimeout(()=>{l(new Error("SDK timeout"))},e),s=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?a(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await l.payments.payGAS(a,e,s)}catch(n){throw t.value=n,n}finally{l.value=!1}}}}const w=((e,a)=>{const l=e.__vccOpts||e;for(const[t,s]of a)l[t]=s;return l})(a({__name:"index",setup(a){const{payGAS:w,isLoading:g}=k("miniapp-timecapsule"),D=e([{id:"1",name:"2025 Memories",content:"Hidden",unlockDate:"2026-01-01",locked:!0},{id:"2",name:"Birthday Gift",content:"Happy Birthday!",unlockDate:"2025-06-15",locked:!1}]),S=e({name:"",content:"",days:"30"}),C=e(null),h=async()=>{if(!g.value&&S.value.name&&S.value.content)try{C.value={msg:"Creating capsule...",type:"loading"},await w("3",`create:${Date.now()}`);const e=new Date;e.setDate(e.getDate()+parseInt(S.value.days)),D.value.push({id:Date.now().toString(),name:S.value.name,content:S.value.content,unlockDate:e.toISOString().split("T")[0],locked:!0}),C.value={msg:"Capsule created!",type:"success"},S.value={name:"",content:"",days:"30"}}catch(e){C.value={msg:e.message||"Error",type:"error"}}};return(e,a)=>{const k=o,w=s,V=n("uni-easyinput");return u(),l(w,{class:"app-container"},{default:t(()=>[c(w,{class:"header"},{default:t(()=>[c(k,{class:"title"},{default:t(()=>[i("Time Capsule")]),_:1}),c(k,{class:"subtitle"},{default:t(()=>[i("Lock content until future date")]),_:1})]),_:1}),C.value?(u(),l(w,{key:0,class:r(["status-msg",C.value.type])},{default:t(()=>[c(k,null,{default:t(()=>[i(p(C.value.msg),1)]),_:1})]),_:1},8,["class"])):d("",!0),c(w,{class:"card"},{default:t(()=>[c(k,{class:"card-title"},{default:t(()=>[i("Your Capsules")]),_:1}),(u(!0),m(f,null,y(D.value,e=>(u(),l(w,{key:e.id,class:"capsule-item"},{default:t(()=>[c(k,{class:"capsule-icon"},{default:t(()=>[i(p(e.locked?"ðŸ”’":"ðŸ”“"),1)]),_:2},1024),c(w,{class:"capsule-info"},{default:t(()=>[c(k,{class:"capsule-name"},{default:t(()=>[i(p(e.name),1)]),_:2},1024),c(k,{class:"capsule-date"},{default:t(()=>[i(p(e.locked?`Unlocks: ${e.unlockDate}`:"Unlocked"),1)]),_:2},1024)]),_:2},1024),e.locked?d("",!0):(u(),l(w,{key:0,class:"open-btn",onClick:a=>(e=>{C.value={msg:`Message: ${e.content}`,type:"success"}})(e)},{default:t(()=>[c(k,null,{default:t(()=>[i("Open")]),_:1})]),_:2},1032,["onClick"]))]),_:2},1024))),128))]),_:1}),c(w,{class:"card"},{default:t(()=>[c(k,{class:"card-title"},{default:t(()=>[i("Create Capsule")]),_:1}),c(V,{modelValue:S.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value.name=e),placeholder:"Capsule name",class:"input-field"},null,8,["modelValue"]),c(V,{modelValue:S.value.content,"onUpdate:modelValue":a[1]||(a[1]=e=>S.value.content=e),placeholder:"Secret message",class:"input-field"},null,8,["modelValue"]),c(w,{class:"date-row"},{default:t(()=>[c(k,{class:"date-label"},{default:t(()=>[i("Unlock in:")]),_:1}),c(w,{class:"date-picker"},{default:t(()=>[c(V,{modelValue:S.value.days,"onUpdate:modelValue":a[2]||(a[2]=e=>S.value.days=e),type:"number",placeholder:"Days",class:"days-input"},null,8,["modelValue"]),c(k,{class:"days-text"},{default:t(()=>[i("days")]),_:1})]),_:1})]),_:1}),c(w,{class:"create-btn",onClick:h,style:v({opacity:_(g)?.6:1})},{default:t(()=>[c(k,null,{default:t(()=>[i(p(_(g)?"Creating...":"Create Capsule (3 GAS)"),1)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-02bcb7dc"]]);export{w as default};

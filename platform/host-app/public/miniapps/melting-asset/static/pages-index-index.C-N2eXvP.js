import{r as a,d as e,o as t,a as s,c as l,w as n,i,b as r,e as o,f as c,g as u,h as d,n as f,t as p,j as h,F as m,k as w,l as y,u as v}from"./index-CPTpUMiH.js";function _(e){const t=a(!1),s=a(null);return{isLoading:t,error:s,payGAS:async(a,l)=>{t.value=!0,s.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const s=setTimeout(()=>{t(new Error("SDK timeout"))},a),l=()=>{clearTimeout(s),window.removeEventListener("miniapp-sdk-ready",l),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",l)})}();return await t.payments.payGAS(e,a,l)}catch(n){throw s.value=n,n}finally{t.value=!1}}}}const g=((a,e)=>{const t=a.__vccOpts||a;for(const[s,l]of e)t[s]=l;return t})(e({__name:"index",setup(e){const{payGAS:g,isLoading:M}=_("miniapp-meltingasset"),A=a([{id:"1",name:"Ice Sculpture",icon:"ðŸ§Š",health:65,lastUpdate:Date.now()},{id:"2",name:"Sand Castle",icon:"ðŸ°",health:42,lastUpdate:Date.now()}]),D=a(null),S=()=>{A.value.forEach(a=>{const e=Date.now()-a.lastUpdate,t=Math.floor(e/36e5);a.health=Math.max(0,a.health-t),a.lastUpdate=Date.now()})},k=async()=>{if(!M.value)try{D.value={msg:"Minting...",type:"loading"},await g("8",`mint:${Date.now()}`);const a=["ðŸ§Š","ðŸ°","ðŸŒ¸","ðŸ¦","â„ï¸"];A.value.push({id:Date.now().toString(),name:"New Asset",icon:a[Math.floor(Math.random()*a.length)],health:100,lastUpdate:Date.now()}),D.value={msg:"Asset minted!",type:"success"}}catch(a){D.value={msg:a.message||"Error",type:"error"}}};let b;return t(()=>{b=setInterval(S,6e4)}),s(()=>clearInterval(b)),(a,e)=>{const t=u,s=i;return r(),l(s,{class:"app-container"},{default:n(()=>[o(s,{class:"header"},{default:n(()=>[o(t,{class:"title"},{default:n(()=>[d("Melting Asset")]),_:1}),o(t,{class:"subtitle"},{default:n(()=>[d("NFTs that decay over time")]),_:1})]),_:1}),D.value?(r(),l(s,{key:0,class:f(["status-msg",D.value.type])},{default:n(()=>[o(t,null,{default:n(()=>[d(p(D.value.msg),1)]),_:1})]),_:1},8,["class"])):c("",!0),o(s,{class:"card"},{default:n(()=>[o(t,{class:"card-title"},{default:n(()=>[d("Your Melting NFTs")]),_:1}),(r(!0),h(m,null,w(A.value,a=>(r(),l(s,{key:a.id,class:"nft-item"},{default:n(()=>[o(t,{class:"nft-icon"},{default:n(()=>[d(p(a.icon),1)]),_:2},1024),o(s,{class:"nft-info"},{default:n(()=>[o(t,{class:"nft-name"},{default:n(()=>[d(p(a.name),1)]),_:2},1024),o(t,{class:"nft-decay"},{default:n(()=>[d(p(a.health)+"% integrity",1)]),_:2},1024)]),_:2},1024),o(s,{class:"health-bar"},{default:n(()=>{return[o(s,{class:"health-fill",style:y({width:a.health+"%",background:(e=a.health,e>70?"#22c55e":e>40?"#f59e0b":"#ef4444")})},null,8,["style"])];var e}),_:2},1024),o(s,{class:"restore-btn",onClick:e=>(async a=>{try{D.value={msg:"Restoring...",type:"loading"},await g("3",`restore:${a.id}`),a.health=Math.min(100,a.health+25),a.lastUpdate=Date.now(),D.value={msg:"Asset restored!",type:"success"}}catch(e){D.value={msg:e.message||"Error",type:"error"}}})(a)},{default:n(()=>[o(t,null,{default:n(()=>[d("ðŸ”§")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),o(s,{class:"card"},{default:n(()=>[o(t,{class:"card-title"},{default:n(()=>[d("Mint New Asset")]),_:1}),o(t,{class:"info-text"},{default:n(()=>[d("New assets start at 100% and decay 1% per hour")]),_:1}),o(s,{class:"mint-btn",onClick:k,style:y({opacity:v(M)?.6:1})},{default:n(()=>[o(t,null,{default:n(()=>[d(p(v(M)?"Minting...":"Mint Asset (8 GAS)"),1)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-a038ba42"]]);export{g as default};

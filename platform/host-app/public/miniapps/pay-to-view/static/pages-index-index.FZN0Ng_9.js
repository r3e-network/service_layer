import{r as e,d as t,c as a,a as l,w as s,i,o as n,b as c,e as o,f as u,g as r,n as d,t as p,h as f,F as v,j as m,I as _,k as w,l as y,u as g}from"./index-cnEndhTQ.js";function k(t){const a=e(!1),l=e(null);return{isLoading:a,error:l,payGAS:async(e,s)=>{a.value=!0,l.value=null;try{const a=await function(e=5e3){return new Promise((t,a)=>{if(window.MiniAppSDK)return void t(window.MiniAppSDK);const l=setTimeout(()=>{a(new Error("SDK timeout"))},e),s=()=>{clearTimeout(l),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?t(window.MiniAppSDK):a(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await a.payments.payGAS(t,e,s)}catch(i){throw l.value=i,i}finally{a.value=!1}}}}const S=((e,t)=>{const a=e.__vccOpts||e;for(const[l,s]of t)a[l]=s;return a})(t({__name:"index",setup(t){const{payGAS:S,isLoading:h}=k("miniapp-paytoview"),C=e([{id:"1",title:"Secret Trading Strategy",creator:"Alice",price:"10",views:234,icon:"ðŸ“Š",unlocked:!1},{id:"2",title:"Exclusive Art Collection",creator:"Bob",price:"15",views:189,icon:"ðŸŽ¨",unlocked:!0},{id:"3",title:"Premium Tutorial Series",creator:"Carol",price:"8",views:456,icon:"ðŸ“š",unlocked:!1},{id:"4",title:"Behind the Scenes",creator:"Dave",price:"5",views:321,icon:"ðŸŽ¬",unlocked:!1}]),A=e({title:"",price:"",description:""}),V=e(null),b=e(3),D=e("42 GAS"),E=a(()=>C.value.filter(e=>e.unlocked).length),G=async()=>{if(A.value.title&&A.value.price){if(!h.value)try{V.value={msg:"Creating content...",type:"loading"},await S("5",`create:${Date.now()}`);const e=["ðŸ“Š","ðŸŽ¨","ðŸ“š","ðŸŽ¬","ðŸŽµ","ðŸ“¹"];C.value.unshift({id:Date.now().toString(),title:A.value.title,creator:"You",price:A.value.price,views:0,icon:e[Math.floor(Math.random()*e.length)],unlocked:!0}),b.value++,A.value={title:"",price:"",description:""},V.value={msg:"Content created!",type:"success"}}catch(e){V.value={msg:e.message||"Error",type:"error"}}}else V.value={msg:"Please fill all fields",type:"error"}};return(e,t)=>{const a=u,k=i,x=_,K=w;return n(),l(k,{class:"app-container"},{default:s(()=>[c(k,{class:"header"},{default:s(()=>[c(a,{class:"title"},{default:s(()=>[r("Pay to View")]),_:1}),c(a,{class:"subtitle"},{default:s(()=>[r("Gated content NFTs")]),_:1})]),_:1}),V.value?(n(),l(k,{key:0,class:d(["status-msg",V.value.type])},{default:s(()=>[c(a,null,{default:s(()=>[r(p(V.value.msg),1)]),_:1})]),_:1},8,["class"])):o("",!0),c(k,{class:"card"},{default:s(()=>[c(a,{class:"card-title"},{default:s(()=>[r("Premium Content")]),_:1}),c(k,{class:"content-list"},{default:s(()=>[(n(!0),f(v,null,m(C.value,e=>(n(),l(k,{key:e.id,class:"content-item",onClick:t=>(async e=>{if(e.unlocked)V.value={msg:"Viewing content...",type:"success"};else if(!h.value)try{V.value={msg:"Unlocking content...",type:"loading"},await S(e.price,`unlock:${e.id}`),e.unlocked=!0,e.views++,V.value={msg:"Content unlocked!",type:"success"}}catch(t){V.value={msg:t.message||"Error",type:"error"}}})(e)},{default:s(()=>[c(a,{class:"content-icon"},{default:s(()=>[r(p(e.icon),1)]),_:2},1024),c(k,{class:"content-info"},{default:s(()=>[c(a,{class:"content-title"},{default:s(()=>[r(p(e.title),1)]),_:2},1024),c(a,{class:"content-creator"},{default:s(()=>[r("by "+p(e.creator),1)]),_:2},1024),c(a,{class:"content-views"},{default:s(()=>[r(p(e.views)+" views",1)]),_:2},1024)]),_:2},1024),c(k,{class:"content-price"},{default:s(()=>[e.unlocked?(n(),l(a,{key:0,class:"unlocked-badge"},{default:s(()=>[r("Unlocked")]),_:1})):(n(),l(a,{key:1,class:"price-text"},{default:s(()=>[r(p(e.price)+" GAS",1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),c(k,{class:"card"},{default:s(()=>[c(a,{class:"card-title"},{default:s(()=>[r("Create Content")]),_:1}),c(k,{class:"create-form"},{default:s(()=>[c(x,{class:"input-field",placeholder:"Content title",modelValue:A.value.title,"onUpdate:modelValue":t[0]||(t[0]=e=>A.value.title=e)},null,8,["modelValue"]),c(x,{class:"input-field",placeholder:"Price in GAS",modelValue:A.value.price,"onUpdate:modelValue":t[1]||(t[1]=e=>A.value.price=e),type:"number"},null,8,["modelValue"]),c(K,{class:"textarea-field",placeholder:"Content description",modelValue:A.value.description,"onUpdate:modelValue":t[2]||(t[2]=e=>A.value.description=e)},null,8,["modelValue"]),c(k,{class:"btn-primary",onClick:G,style:y({opacity:g(h)?.6:1})},{default:s(()=>[c(a,null,{default:s(()=>[r(p(g(h)?"Creating...":"Create (5 GAS fee)"),1)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),c(k,{class:"card"},{default:s(()=>[c(a,{class:"card-title"},{default:s(()=>[r("Your Stats")]),_:1}),c(k,{class:"stats-grid"},{default:s(()=>[c(k,{class:"stat-item"},{default:s(()=>[c(a,{class:"stat-value"},{default:s(()=>[r(p(E.value),1)]),_:1}),c(a,{class:"stat-label"},{default:s(()=>[r("Unlocked")]),_:1})]),_:1}),c(k,{class:"stat-item"},{default:s(()=>[c(a,{class:"stat-value"},{default:s(()=>[r(p(b.value),1)]),_:1}),c(a,{class:"stat-label"},{default:s(()=>[r("Created")]),_:1})]),_:1}),c(k,{class:"stat-item"},{default:s(()=>[c(a,{class:"stat-value"},{default:s(()=>[r(p(D.value),1)]),_:1}),c(a,{class:"stat-label"},{default:s(()=>[r("Earned")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-579d7791"]]);export{S as default};

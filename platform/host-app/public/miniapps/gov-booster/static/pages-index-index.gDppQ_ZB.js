import{r as a,d as e,c as s,w as t,i as l,a as o,o as u,b as n,e as d,f as r,g as i,n as c,t as p,h as v,F as f,j as y,k as _,u as m}from"./index-BOflAvc0.js";function b(e){const s=a(!1),t=a(null);return{isLoading:s,error:t,payGAS:async(a,l)=>{s.value=!0,t.value=null;try{const s=await function(a=5e3){return new Promise((e,s)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const t=setTimeout(()=>{s(new Error("SDK timeout"))},a),l=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",l),window.MiniAppSDK?e(window.MiniAppSDK):s(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",l)})}();return await s.payments.payGAS(e,a,l)}catch(o){throw t.value=o,o}finally{s.value=!1}}}}const w=((a,e)=>{const s=a.__vccOpts||a;for(const[t,l]of e)s[t]=l;return s})(e({__name:"index",setup(e){const{payGAS:w,isLoading:g}=b("miniapp-gov-booster"),k=a("10"),x=a(30),A=a(100),S=a(1),V=a(3),h=a(null),K=a([{id:1,title:"Increase block rewards",votes:1250,endsIn:"2d"},{id:2,title:"Lower gas fees",votes:890,endsIn:"5d"},{id:3,title:"Treasury allocation",votes:650,endsIn:"7d"}]),L=[{days:7,label:"1w",boost:1.5},{days:30,label:"1m",boost:2},{days:90,label:"3m",boost:3},{days:180,label:"6m",boost:5}],D=async()=>{var a;if(g.value)return;const e=parseFloat(k.value);if(e<1)h.value={msg:"Min lock: 1 GAS",type:"error"};else try{h.value={msg:"Locking tokens...",type:"loading"},await w(k.value,`boost:${x.value}`);const s=(null==(a=L.find(a=>a.days===x.value))?void 0:a.boost)||1;S.value=s,A.value+=e*s,h.value={msg:`Boosted ${s}x for ${x.value} days!`,type:"success"}}catch(s){h.value={msg:s.message||"Error",type:"error"}}};return(a,e)=>{const b=r,w=l,I=o("uni-easyinput");return u(),s(w,{class:"app-container"},{default:t(()=>[n(w,{class:"header"},{default:t(()=>[n(b,{class:"title"},{default:t(()=>[i("Vote Booster")]),_:1}),n(b,{class:"subtitle"},{default:t(()=>[i("Amplify your governance power")]),_:1})]),_:1}),h.value?(u(),s(w,{key:0,class:c(["status-msg",h.value.type])},{default:t(()=>[n(b,null,{default:t(()=>[i(p(h.value.msg),1)]),_:1})]),_:1},8,["class"])):d("",!0),n(w,{class:"card"},{default:t(()=>[n(w,{class:"stats-grid"},{default:t(()=>[n(w,{class:"stat-box"},{default:t(()=>[n(b,{class:"stat-value"},{default:t(()=>{return[i(p((a=A.value,function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,0))),1)];var a}),_:1}),n(b,{class:"stat-label"},{default:t(()=>[i("Voting Power")]),_:1})]),_:1}),n(w,{class:"stat-box"},{default:t(()=>[n(b,{class:"stat-value"},{default:t(()=>[i(p(S.value)+"x",1)]),_:1}),n(b,{class:"stat-label"},{default:t(()=>[i("Boost")]),_:1})]),_:1}),n(w,{class:"stat-box"},{default:t(()=>[n(b,{class:"stat-value"},{default:t(()=>[i(p(V.value),1)]),_:1}),n(b,{class:"stat-label"},{default:t(()=>[i("Active")]),_:1})]),_:1})]),_:1})]),_:1}),n(w,{class:"card"},{default:t(()=>[n(b,{class:"card-title"},{default:t(()=>[i("Boost Your Vote")]),_:1}),n(I,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),type:"number",placeholder:"Amount to lock"},null,8,["modelValue"]),n(w,{class:"duration-row"},{default:t(()=>[(u(),v(f,null,y(L,a=>n(w,{key:a.days,class:c(["duration-btn",x.value===a.days&&"active"]),onClick:e=>x.value=a.days},{default:t(()=>[n(b,{class:"duration-label"},{default:t(()=>[i(p(a.label),1)]),_:2},1024),n(b,{class:"duration-boost"},{default:t(()=>[i(p(a.boost)+"x",1)]),_:2},1024)]),_:2},1032,["class","onClick"])),64))]),_:1}),n(w,{class:"boost-btn",onClick:D,style:_({opacity:m(g)?.6:1})},{default:t(()=>[n(b,null,{default:t(()=>[i(p(m(g)?"Processing...":"Lock & Boost"),1)]),_:1})]),_:1},8,["style"])]),_:1}),n(w,{class:"card"},{default:t(()=>[n(b,{class:"card-title"},{default:t(()=>[i("Active Proposals")]),_:1}),n(w,{class:"proposals-list"},{default:t(()=>[0===K.value.length?(u(),s(b,{key:0,class:"empty"},{default:t(()=>[i("No active proposals")]),_:1})):d("",!0),(u(!0),v(f,null,y(K.value,(a,e)=>(u(),s(w,{key:e,class:"proposal-item",onClick:e=>(async a=>{h.value={msg:`Voting on proposal #${a}...`,type:"loading"},setTimeout(()=>{h.value={msg:"Vote cast successfully!",type:"success"}},1e3)})(a.id)},{default:t(()=>[n(b,{class:"proposal-title"},{default:t(()=>[i(p(a.title),1)]),_:2},1024),n(w,{class:"proposal-meta"},{default:t(()=>[n(b,{class:"proposal-votes"},{default:t(()=>[i(p(a.votes)+" votes",1)]),_:2},1024),n(b,{class:"proposal-ends"},{default:t(()=>[i(p(a.endsIn),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-74abbbbb"]]);export{w as default};

import{r as e,d as a,c as l,w as t,i as s,a as u,o as d,b as n,e as o,f as r,g as i,n as c,t as p,u as f}from"./index-CkkrLMhq.js";function v(a){const l=e(!1),t=e(null);return{isLoading:l,error:t,payGAS:async(e,s)=>{l.value=!0,t.value=null;try{const l=await function(e=5e3){return new Promise((a,l)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const t=setTimeout(()=>{l(new Error("SDK timeout"))},e),s=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?a(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await l.payments.payGAS(a,e,s)}catch(u){throw t.value=u,u}finally{l.value=!1}}}}const _="0.010",m=((e,a)=>{const l=e.__vccOpts||e;for(const[t,s]of a)l[t]=s;return l})(a({__name:"index",setup(a){const{payGAS:m,isLoading:w}=v("miniapp-compound-capsule"),y=e({apy:18.5,tvl:125e3,compoundFreq:"Every 6h"}),A=e({deposited:100,earned:1.2345,est30d:1.54}),S=e(""),g=e(null),G=(e,a=2)=>function(e,a=2){return e>=1e6?(e/1e6).toFixed(a)+"M":e>=1e3?(e/1e3).toFixed(a)+"K":e.toFixed(a)}(e,a),D=async()=>{if(w.value)return;const e=parseFloat(S.value);if(e>0)try{await m((e+parseFloat(_)).toFixed(3),`compound:deposit:${e}`),A.value.deposited+=e,g.value={msg:`Deposited ${e} GAS`,type:"success"}}catch(a){g.value={msg:(null==a?void 0:a.message)||"Payment failed",type:"error"}}else g.value={msg:"Enter a valid amount",type:"error"}};return(e,a)=>{const v=r,m=s,E=u("uni-easyinput");return d(),l(m,{class:"app-container"},{default:t(()=>[n(m,{class:"header"},{default:t(()=>[n(v,{class:"title"},{default:t(()=>[i("Compound Capsule")]),_:1}),n(v,{class:"subtitle"},{default:t(()=>[i("Auto-compounding savings")]),_:1})]),_:1}),g.value?(d(),l(m,{key:0,class:c(["status-msg",g.value.type])},{default:t(()=>[n(v,null,{default:t(()=>[i(p(g.value.msg),1)]),_:1})]),_:1},8,["class"])):o("",!0),n(m,{class:"card"},{default:t(()=>[n(v,{class:"card-title"},{default:t(()=>[i("Vault Stats")]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("APY")]),_:1}),n(v,{class:"v"},{default:t(()=>[i(p(y.value.apy)+"%",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("TVL")]),_:1}),n(v,{class:"v"},{default:t(()=>[i(p(G(y.value.tvl,0))+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("Compound freq")]),_:1}),n(v,{class:"v"},{default:t(()=>[i(p(y.value.compoundFreq),1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:t(()=>[n(v,{class:"card-title"},{default:t(()=>[i("Your Position")]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("Deposited")]),_:1}),n(v,{class:"v"},{default:t(()=>[i(p(G(A.value.deposited,2))+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("Earned")]),_:1}),n(v,{class:"v"},{default:t(()=>[i("+"+p(G(A.value.earned,4))+" GAS",1)]),_:1})]),_:1}),n(m,{class:"row"},{default:t(()=>[n(v,null,{default:t(()=>[i("Est. 30d")]),_:1}),n(v,{class:"v"},{default:t(()=>[i(p(G(A.value.est30d,2))+" GAS",1)]),_:1})]),_:1})]),_:1}),n(m,{class:"card"},{default:t(()=>[n(v,{class:"card-title"},{default:t(()=>[i("Manage")]),_:1}),n(E,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),type:"number",placeholder:"Amount (GAS)"},null,8,["modelValue"]),n(m,{class:"action-btn",onClick:D},{default:t(()=>[n(v,null,{default:t(()=>[i(p(f(w)?"Processing...":"Deposit"),1)]),_:1})]),_:1}),n(v,{class:"note"},{default:t(()=>[i("Mock deposit fee: "+p(_)+" GAS")]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-d729278c"]]);export{m as default};

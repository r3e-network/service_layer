import{r as a,d as e,c as t,w as l,i as s,a as u,o as n,b as r,e as i,f as o,g as c,n as d,t as p,h as v,u as f}from"./index-CEVzcO_a.js";function m(e){const t=a(!1),l=a(null);return{isLoading:t,error:l,payGAS:async(a,s)=>{t.value=!0,l.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const l=setTimeout(()=>{t(new Error("SDK timeout"))},a),s=()=>{clearTimeout(l),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await t.payments.payGAS(e,a,s)}catch(u){throw l.value=u,u}finally{t.value=!1}}}}const y=((a,e)=>{const t=a.__vccOpts||a;for(const[l,s]of e)t[l]=s;return t})(e({__name:"index",setup(e){const{payGAS:y,isLoading:_}=m("miniapp-unbreakable-vault"),w=a(1250.75),b=a(""),g=a(""),S=a(null),h=async()=>{if(_.value)return;const a=parseFloat(b.value);if(!a||a<=0)S.value={msg:"Invalid amount",type:"error"};else try{await y(String(a),`vault:deposit:${a}`),w.value+=a,S.value={msg:`Deposited ${a} GAS`,type:"success"},b.value=""}catch(e){S.value={msg:e.message||"Error",type:"error"}}},A=()=>{const a=parseFloat(g.value);!a||a<=0||a>w.value?S.value={msg:"Invalid amount",type:"error"}:(S.value={msg:"Withdrawal request submitted. Available in 24h",type:"success"},g.value="")};return(a,e)=>{const m=o,y=s,D=u("uni-easyinput");return n(),t(y,{class:"app-container"},{default:l(()=>[r(y,{class:"header"},{default:l(()=>[r(m,{class:"title"},{default:l(()=>[c("Unbreakable Vault")]),_:1}),r(m,{class:"subtitle"},{default:l(()=>[c("Secure asset storage")]),_:1})]),_:1}),S.value?(n(),t(y,{key:0,class:d(["status-msg",S.value.type])},{default:l(()=>[r(m,null,{default:l(()=>[c(p(S.value.msg),1)]),_:1})]),_:1},8,["class"])):i("",!0),r(y,{class:"card"},{default:l(()=>[r(m,{class:"card-title"},{default:l(()=>[c("Vault Balance")]),_:1}),r(y,{class:"balance-display"},{default:l(()=>[r(m,{class:"balance"},{default:l(()=>{return[c(p((a=w.value,function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,2))),1)];var a}),_:1}),r(m,{class:"balance-label"},{default:l(()=>[c("GAS")]),_:1})]),_:1}),r(y,{class:"security-row"},{default:l(()=>[r(m,{class:"security-label"},{default:l(()=>[c("Security Level")]),_:1}),r(m,{class:"security-value"},{default:l(()=>[c("ðŸ”’ Maximum")]),_:1})]),_:1})]),_:1}),r(y,{class:"card"},{default:l(()=>[r(m,{class:"card-title"},{default:l(()=>[c("Deposit")]),_:1}),r(D,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),type:"number",placeholder:"Amount to deposit",class:"input"},null,8,["modelValue"]),r(y,{class:"action-btn",onClick:h,style:v({opacity:f(_)?.6:1})},{default:l(()=>[r(m,null,{default:l(()=>[c(p(f(_)?"Processing...":"Deposit to Vault"),1)]),_:1})]),_:1},8,["style"])]),_:1}),r(y,{class:"card"},{default:l(()=>[r(m,{class:"card-title"},{default:l(()=>[c("Withdraw")]),_:1}),r(D,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),type:"number",placeholder:"Amount to withdraw",class:"input"},null,8,["modelValue"]),r(m,{class:"warning-text"},{default:l(()=>[c("âš  24h time lock applies")]),_:1}),r(y,{class:"action-btn secondary",onClick:A},{default:l(()=>[r(m,null,{default:l(()=>[c("Request Withdrawal")]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-91cc47b1"]]);export{y as default};

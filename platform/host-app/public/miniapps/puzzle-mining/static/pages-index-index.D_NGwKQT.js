import{r as e,d as a,c as l,w as s,i as t,o as u,a as n,b as r,e as i,f as d,n as o,t as c,g as v,h as f,F as p,j as _}from"./index-DXFziV8F.js";function m(e=5e3){return new Promise((a,l)=>{if(window.MiniAppSDK)return void a(window.MiniAppSDK);const s=setTimeout(()=>{l(new Error("SDK timeout"))},e),t=()=>{clearTimeout(s),window.removeEventListener("miniapp-sdk-ready",t),window.MiniAppSDK?a(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",t)})}const g="miniapp-puzzlemining",y=((e,a)=>{const l=e.__vccOpts||e;for(const[s,t]of a)l[s]=t;return l})(a({__name:"index",setup(a){const{payGAS:y}=function(a){const l=e(!1),s=e(null);return{isLoading:l,error:s,payGAS:async(e,t)=>{l.value=!0,s.value=null;try{const l=await m();return await l.payments.payGAS(a,e,t)}catch(u){throw s.value=u,u}finally{l.value=!1}}}}(g),{requestRandom:w}=function(a){const l=e(!1),s=e(null);return{isLoading:l,error:s,requestRandom:async()=>{l.value=!0,s.value=null;try{const e=await m();return await e.rng.requestRandom(a)}catch(e){throw s.value=e,e}finally{l.value=!1}}}}(g),z=e(0),M=e(0),S=e(0),h=e(0),k=e(!1),x=e(null),A=e([{value:"ðŸ”·",solved:!1},{value:"ðŸ”¶",solved:!1},{value:"ðŸ”·",solved:!1},{value:"ðŸ”¶",solved:!1},{value:"ðŸ”·",solved:!1},{value:"ðŸ”¶",solved:!1},{value:"ðŸ”·",solved:!1},{value:"ðŸ”¶",solved:!1},{value:"ðŸ”·",solved:!1}]),b=async()=>{if(k.value)return;if(A.value.filter(e=>!e.solved).length>3)x.value={msg:"Solve more puzzles first",type:"error"};else{k.value=!0;try{await y("0.5","mining:start");const e=await w(),a=parseInt(e.randomness.slice(0,2),16)%10/10+.5;M.value++,S.value+=a,z.value=0,A.value.forEach(e=>e.solved=!1),x.value={msg:`Mined! Earned ${a.toFixed(2)} GAS`,type:"success"}}catch(e){x.value={msg:e.message||"Error",type:"error"}}finally{k.value=!1}}};return(e,a)=>{const m=i,g=t;return u(),l(g,{class:"app-container"},{default:s(()=>[n(g,{class:"header"},{default:s(()=>[n(m,{class:"title"},{default:s(()=>[d("Puzzle Mining")]),_:1}),n(m,{class:"subtitle"},{default:s(()=>[d("Mining puzzle game")]),_:1})]),_:1}),x.value?(u(),l(g,{key:0,class:o(["status-msg",x.value.type])},{default:s(()=>[n(m,null,{default:s(()=>[d(c(x.value.msg),1)]),_:1})]),_:1},8,["class"])):r("",!0),n(g,{class:"card"},{default:s(()=>[n(m,{class:"card-title"},{default:s(()=>[d("Mining Progress")]),_:1}),n(g,{class:"progress-bar"},{default:s(()=>[n(g,{class:"progress-fill",style:v({width:z.value+"%"})},null,8,["style"])]),_:1}),n(g,{class:"progress-text"},{default:s(()=>[n(m,null,{default:s(()=>[d(c(z.value)+"% Complete",1)]),_:1})]),_:1})]),_:1}),n(g,{class:"card"},{default:s(()=>[n(m,{class:"card-title"},{default:s(()=>[d("Puzzle Challenge")]),_:1}),n(g,{class:"puzzle-grid"},{default:s(()=>[(u(!0),f(p,null,_(A.value,(e,a)=>(u(),l(g,{key:a,class:o(["puzzle-piece",e.solved&&"solved"]),onClick:e=>{return l=a,void(A.value[l].solved||(A.value[l].solved=!0,h.value++,z.value=Math.min(100,z.value+11),x.value={msg:`Puzzle piece ${l+1} solved!`,type:"success"}));var l}},{default:s(()=>[n(m,null,{default:s(()=>[d(c(e.value),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),n(g,{class:"mine-btn",onClick:b,style:v({opacity:k.value?.6:1})},{default:s(()=>[n(m,null,{default:s(()=>[d(c(k.value?"Mining...":"Start Mining"),1)]),_:1})]),_:1},8,["style"])]),_:1}),n(g,{class:"card"},{default:s(()=>[n(m,{class:"card-title"},{default:s(()=>[d("Mining Stats")]),_:1}),n(g,{class:"stats-grid"},{default:s(()=>[n(g,{class:"stat"},{default:s(()=>[n(m,{class:"stat-value"},{default:s(()=>[d(c(M.value),1)]),_:1}),n(m,{class:"stat-label"},{default:s(()=>[d("Blocks")]),_:1})]),_:1}),n(g,{class:"stat"},{default:s(()=>[n(m,{class:"stat-value"},{default:s(()=>{return[d(c((e=S.value,function(e,a=2){return e>=1e6?(e/1e6).toFixed(a)+"M":e>=1e3?(e/1e3).toFixed(a)+"K":e.toFixed(a)}(e,2))),1)];var e}),_:1}),n(m,{class:"stat-label"},{default:s(()=>[d("Rewards")]),_:1})]),_:1}),n(g,{class:"stat"},{default:s(()=>[n(m,{class:"stat-value"},{default:s(()=>[d(c(h.value),1)]),_:1}),n(m,{class:"stat-label"},{default:s(()=>[d("Puzzles")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-56828603"]]);export{y as default};

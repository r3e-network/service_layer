import{r as e,d as l,c as a,w as s,i as t,a as n,o as u,b as o,e as i,f as r,g as c,n as d,t as v,h as f,F as p,j as _,k as m}from"./index-DcqTCKMu.js";function w(l){const a=e(!1),s=e(null);return{isLoading:a,error:s,payGAS:async(e,t)=>{a.value=!0,s.value=null;try{const a=await function(e=5e3){return new Promise((l,a)=>{if(window.MiniAppSDK)return void l(window.MiniAppSDK);const s=setTimeout(()=>{a(new Error("SDK timeout"))},e),t=()=>{clearTimeout(s),window.removeEventListener("miniapp-sdk-ready",t),window.MiniAppSDK?l(window.MiniAppSDK):a(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",t)})}();return await a.payments.payGAS(l,e,t)}catch(n){throw s.value=n,n}finally{a.value=!1}}}}const y=((e,l)=>{const a=e.__vccOpts||e;for(const[s,t]of l)a[s]=t;return a})(l({__name:"index",setup(l){const{payGAS:y}=w("miniapp-nftevolve"),S=e([{id:"1",name:"Fire Dragon",icon:"ðŸ‰",level:3,xp:75},{id:"2",name:"Ice Phoenix",icon:"ðŸ¦…",level:2,xp:40}]),k=e(null),x=e(null),g=async()=>{if(k.value)try{await y(String(5*k.value.level),`evolve:${k.value.id}`),k.value.level++,k.value.xp=0,x.value={msg:`${k.value.name} evolved!`,type:"success"},k.value=null}catch(e){x.value={msg:e.message||"Error",type:"error"}}};return(e,l)=>{const w=r,y=t,A=n("uni-popup");return u(),a(y,{class:"app-container"},{default:s(()=>[o(y,{class:"header"},{default:s(()=>[o(w,{class:"title"},{default:s(()=>[c("NFT Evolve")]),_:1}),o(w,{class:"subtitle"},{default:s(()=>[c("Level up your NFTs")]),_:1})]),_:1}),x.value?(u(),a(y,{key:0,class:d(["status-msg",x.value.type])},{default:s(()=>[o(w,null,{default:s(()=>[c(v(x.value.msg),1)]),_:1})]),_:1},8,["class"])):i("",!0),o(y,{class:"card"},{default:s(()=>[o(w,{class:"card-title"},{default:s(()=>[c("Your NFTs")]),_:1}),(u(!0),f(p,null,_(S.value,e=>(u(),a(y,{key:e.id,class:"nft-item",onClick:l=>k.value=e},{default:s(()=>[o(w,{class:"nft-icon"},{default:s(()=>[c(v(e.icon),1)]),_:2},1024),o(y,{class:"nft-info"},{default:s(()=>[o(w,{class:"nft-name"},{default:s(()=>[c(v(e.name),1)]),_:2},1024),o(w,{class:"nft-level"},{default:s(()=>[c("Level "+v(e.level),1)]),_:2},1024)]),_:2},1024),o(y,{class:"xp-bar"},{default:s(()=>[o(y,{class:"xp-fill",style:m({width:e.xp+"%"})},null,8,["style"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),k.value?(u(),a(A,{key:1,ref:"popup",type:"center"},{default:s(()=>[o(y,{class:"evolve-modal"},{default:s(()=>[o(w,{class:"modal-title"},{default:s(()=>{var e;return[c("Evolve "+v(null==(e=k.value)?void 0:e.name)+"?",1)]}),_:1}),o(w,{class:"modal-cost"},{default:s(()=>{var e;return[c("Cost: "+v(5*(null==(e=k.value)?void 0:e.level))+" GAS",1)]}),_:1}),o(y,{class:"modal-btns"},{default:s(()=>[o(y,{class:"cancel-btn",onClick:l[0]||(l[0]=e=>k.value=null)},{default:s(()=>[o(w,null,{default:s(()=>[c("Cancel")]),_:1})]),_:1}),o(y,{class:"evolve-btn",onClick:g},{default:s(()=>[o(w,null,{default:s(()=>[c("Evolve")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)):i("",!0)]),_:1})}}}),[["__scopeId","data-v-21d6456e"]]);export{y as default};

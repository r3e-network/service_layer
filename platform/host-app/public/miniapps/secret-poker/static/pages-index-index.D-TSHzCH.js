import{r as a,d as e,c as l,w as t,i as s,a as u,o as r,b as n,e as o,f as c,g as d,n as i,t as v,h as f,F as p,j as y,k as _}from"./index-CPljJduc.js";function m(a=5e3){return new Promise((e,l)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const t=setTimeout(()=>{l(new Error("SDK timeout"))},a),s=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}const w="miniapp-secretpoker",g=((a,e)=>{const l=a.__vccOpts||a;for(const[t,s]of e)l[t]=s;return l})(e({__name:"index",setup(e){const{payGAS:g}=function(e){const l=a(!1),t=a(null);return{isLoading:l,error:t,payGAS:async(a,s)=>{l.value=!0,t.value=null;try{const l=await m();return await l.payments.payGAS(e,a,s)}catch(u){throw t.value=u,u}finally{l.value=!1}}}}(w),{requestRandom:S}=function(e){const l=a(!1),t=a(null);return{isLoading:l,error:t,requestRandom:async()=>{l.value=!0,t.value=null;try{const a=await m();return await a.rng.requestRandom(e)}catch(a){throw t.value=a,a}finally{l.value=!1}}}}(w),A=a("1"),h=a(0),k=a(0),b=a(0),G=a(0),E=a(!1),K=a(null),F=a([{value:"Aâ™ ",revealed:!1},{value:"Kâ™¥",revealed:!1},{value:"Qâ™¦",revealed:!1}]),x=async()=>{if(E.value)return;const a=parseFloat(A.value);if(a<.1)K.value={msg:"Min bet: 0.1 GAS",type:"error"};else{E.value=!0;try{await g(A.value,"poker:bet"),h.value+=a,K.value={msg:`Bet ${a} GAS placed`,type:"success"}}catch(e){K.value={msg:e.message||"Error",type:"error"}}finally{E.value=!1}}},D=()=>{E.value||(h.value=0,F.value.forEach(a=>a.revealed=!1),K.value={msg:"Folded hand",type:"error"})},M=async()=>{if(!E.value){E.value=!0;try{const a=await S(),e=parseInt(a.randomness.slice(0,2),16)%2==0;F.value.forEach(a=>a.revealed=!0),k.value++,e?(b.value++,G.value+=2*h.value,K.value={msg:`Won ${2*h.value} GAS!`,type:"success"}):K.value={msg:"Lost this round",type:"error"},h.value=0}catch(a){K.value={msg:a.message||"Error",type:"error"}}finally{E.value=!1}}};return(a,e)=>{const m=c,w=s,g=u("uni-easyinput");return r(),l(w,{class:"app-container"},{default:t(()=>[n(w,{class:"header"},{default:t(()=>[n(m,{class:"title"},{default:t(()=>[d("Secret Poker")]),_:1}),n(m,{class:"subtitle"},{default:t(()=>[d("Hidden card poker game")]),_:1})]),_:1}),K.value?(r(),l(w,{key:0,class:i(["status-msg",K.value.type])},{default:t(()=>[n(m,null,{default:t(()=>[d(v(K.value.msg),1)]),_:1})]),_:1},8,["class"])):o("",!0),n(w,{class:"card"},{default:t(()=>[n(m,{class:"card-title"},{default:t(()=>[d("Your Hand")]),_:1}),n(w,{class:"cards-row"},{default:t(()=>[(r(!0),f(p,null,y(F.value,(a,e)=>(r(),l(w,{key:e,class:i(["poker-card",a.revealed&&"revealed"])},{default:t(()=>[n(m,null,{default:t(()=>[d(v(a.revealed?a.value:"ðŸ‚ "),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),n(w,{class:"info-row"},{default:t(()=>[n(m,{class:"info-label"},{default:t(()=>[d("Pot:")]),_:1}),n(m,{class:"info-value"},{default:t(()=>[d(v(h.value)+" GAS",1)]),_:1})]),_:1})]),_:1}),n(w,{class:"card"},{default:t(()=>[n(m,{class:"card-title"},{default:t(()=>[d("Actions")]),_:1}),n(g,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a),type:"number",placeholder:"Bet amount (GAS)"},null,8,["modelValue"]),n(w,{class:"actions-row"},{default:t(()=>[n(w,{class:"action-btn",onClick:D,style:_({opacity:E.value?.6:1})},{default:t(()=>[n(m,null,{default:t(()=>[d("Fold")]),_:1})]),_:1},8,["style"]),n(w,{class:"action-btn primary",onClick:x,style:_({opacity:E.value?.6:1})},{default:t(()=>[n(m,null,{default:t(()=>[d(v(E.value?"Playing...":"Bet"),1)]),_:1})]),_:1},8,["style"]),n(w,{class:"action-btn",onClick:M,style:_({opacity:E.value?.6:1})},{default:t(()=>[n(m,null,{default:t(()=>[d("Reveal")]),_:1})]),_:1},8,["style"])]),_:1})]),_:1}),n(w,{class:"card"},{default:t(()=>[n(m,{class:"card-title"},{default:t(()=>[d("Game Stats")]),_:1}),n(w,{class:"stats-grid"},{default:t(()=>[n(w,{class:"stat"},{default:t(()=>[n(m,{class:"stat-value"},{default:t(()=>[d(v(k.value),1)]),_:1}),n(m,{class:"stat-label"},{default:t(()=>[d("Games")]),_:1})]),_:1}),n(w,{class:"stat"},{default:t(()=>[n(m,{class:"stat-value"},{default:t(()=>[d(v(b.value),1)]),_:1}),n(m,{class:"stat-label"},{default:t(()=>[d("Won")]),_:1})]),_:1}),n(w,{class:"stat"},{default:t(()=>[n(m,{class:"stat-value"},{default:t(()=>{return[d(v((a=G.value,function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,2))),1)];var a}),_:1}),n(m,{class:"stat-label"},{default:t(()=>[d("Earnings")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-71a96551"]]);export{g as default};

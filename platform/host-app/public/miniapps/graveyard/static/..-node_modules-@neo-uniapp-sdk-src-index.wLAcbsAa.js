import{m as a,p as e,c as t,d as n,s as o,a as l,w as s,i as r,f as i,g as c,h as d,t as u,o as v,e as f,v as p,x as h,y as w,n as m,b as g,r as y,F as _,j as M}from"./index-r9W9FLDJ.js";import{_ as b}from"./index.R3bqmPl-.js";const S=["https://miniapp.neo.org","https://testnet.miniapp.neo.org"];function k(a){if(!a||"object"!=typeof a)return!1;const e="function"==typeof a.invoke&&"function"==typeof a.getConfig,t="object"==typeof a.wallet||"object"==typeof a.payments;return e||t}function D(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return k(window.MiniAppSDK)?void e(window.MiniAppSDK):void t(new Error("SDK validation failed"));const n=setTimeout(()=>{t(new Error("SDK timeout"))},a),o=()=>{if(clearTimeout(n),window.removeEventListener("miniapp-sdk-ready",o),window.MiniAppSDK){if(!k(window.MiniAppSDK))return void t(new Error("SDK validation failed"));e(window.MiniAppSDK)}else t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",o)})}function E(a){return a.debug&&console.log("[Neo] Creating H5 bridge for:",a.appId),D()}function A(){return window.MiniAppSDK??null}async function I(a,e){if(!(await D().catch(()=>null)))throw new Error("SDK not available");const t=S[0];return new Promise((n,o)=>{const l=`${a}-${Date.now()}`,s=a=>{var e,t;(t=a.origin,S.includes(t))?(null==(e=a.data)?void 0:e.id)===l&&(window.removeEventListener("message",s),a.data.error?o(new Error(a.data.error)):n(a.data.result)):console.warn("[Neo SDK] Rejected message from invalid origin:",a.origin)};window.addEventListener("message",s),window.parent.postMessage({type:"bridge",method:a,params:e,id:l},t),setTimeout(()=>{window.removeEventListener("message",s),o(new Error("Bridge timeout"))},5e3)})}const K="https://api.neo-service-layer.io";function C(){const t=a(null),n=a({GAS:"0",NEO:"0"}),o=a(!1),l=a(!1),s=a(null);return e(()=>{const a=A();a&&a.wallet.getAddress().then(a=>{t.value=a,o.value=!0}).catch(()=>{})}),{address:t,balances:n,isConnected:o,isLoading:l,error:s,connect:async()=>{l.value=!0,s.value=null;try{const a=await D();t.value=await a.wallet.getAddress(),o.value=!0}catch(a){s.value=a}finally{l.value=!1}},invokeIntent:async a=>{var e;const t=A();if(!(null==(e=null==t?void 0:t.wallet)?void 0:e.invokeIntent))throw new Error("invokeIntent not available");return t.wallet.invokeIntent(a)},invokeContract:async a=>(await D()).invoke("invokeFunction",{contract:a.scriptHash,method:a.operation,args:a.args}),getAddress:async()=>(await D()).wallet.getAddress(),getBalance:async a=>{var e;l.value=!0,s.value=null;try{const t=await fetch(`${K}/wallet-balance`,{method:"GET",credentials:"include"});if(!t.ok){const a=await t.json();throw new Error((null==(e=a.error)?void 0:e.message)||"Failed to get balance")}const o=await t.json();return n.value=o.balances,a?o.balances[a]||"0":o.balances}catch(t){throw s.value=t,t}finally{l.value=!1}},getTransactions:async(a=20)=>{var e;l.value=!0,s.value=null;try{const t=await fetch(`${K}/wallet-transactions?limit=${a}`,{method:"GET",credentials:"include"});if(!t.ok){const a=await t.json();throw new Error((null==(e=a.error)?void 0:e.message)||"Failed to get transactions")}return(await t.json()).transactions}catch(t){throw s.value=t,t}finally{l.value=!1}}}}function x(e){const t=a(!1),n=a(null);return{isLoading:t,error:n,payGAS:async(a,o)=>{t.value=!0,n.value=null;try{const t=await D();return await t.payments.payGAS(e,a,o)}catch(l){throw n.value=l,l}finally{t.value=!1}}}}function j(e){const t=a(!1),n=a(null);return{isLoading:t,error:n,vote:async(a,o,l)=>{t.value=!0,n.value=null;try{const t=await D();return await t.governance.vote(e,a,o,l)}catch(s){throw n.value=s,s}finally{t.value=!1}},getCandidates:async()=>{t.value=!0,n.value=null;try{const a=await D();return await a.governance.getCandidates()}catch(a){throw n.value=a,a}finally{t.value=!1}}}}function L(e){const t=a(!1),n=a(null);return{isLoading:t,error:n,requestRandom:async()=>{t.value=!0,n.value=null;try{const a=await D();return await a.rng.requestRandom(e)}catch(a){throw n.value=a,a}finally{t.value=!1}}}}function T(){const e=a(!1),t=a(null);return{isLoading:e,error:t,getPrice:async a=>{e.value=!0,t.value=null;try{const e=await D();return await e.datafeed.getPrice(a)}catch(n){throw t.value=n,n}finally{e.value=!1}}}}const N=a("en");function G(a){(async()=>{try{const e=await I("getLocale",{appId:a});(null==e?void 0:e.locale)&&(N.value=e.locale)}catch{const a=localStorage.getItem("lang");a&&(N.value=a)}})();return{locale:t(()=>N.value),setLocale:async e=>{N.value=e,localStorage.setItem("lang",e);try{await I("setLocale",{appId:a,locale:e})}catch{}}}}const P="https://api.neo-service-layer.io";function F(){const e=a(!1),t=a(null);return{isLoading:e,error:t,checkEligibility:async()=>{var a;e.value=!0,t.value=null;try{const e=await fetch(`${P}/gas-sponsor-check`,{method:"GET",credentials:"include"});if(!e.ok){const t=await e.json();throw new Error((null==(a=t.error)?void 0:a.message)||"Check failed")}return await e.json()}catch(n){throw t.value=n,n}finally{e.value=!1}},requestSponsorship:async a=>{var n;e.value=!0,t.value=null;try{const e=await fetch(`${P}/gas-sponsor-request`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({amount:a})});if(!e.ok){const a=await e.json();throw new Error((null==(n=a.error)?void 0:n.message)||"Request failed")}return await e.json()}catch(o){throw t.value=o,o}finally{e.value=!1}}}}const B=()=>`mock-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,V={wallet:{getAddress:async()=>(console.log("[MockSDK] getAddress called"),"NXV7ZhHiyM1aHXwpVsRZC6BwNFP2jghXAq"),invokeIntent:async a=>(console.log("[MockSDK] invokeIntent:",a),{txid:B()})},payments:{payGAS:async(a,e,t)=>(console.log("[MockSDK] payGAS:",{appId:a,amount:e,memo:t}),await new Promise(a=>setTimeout(a,800)),{request_id:B(),user_id:"mock-user",intent:"payments",constraints:{settlement:"GAS_ONLY"},invocation:{contract:"0x0bb8f09e6d3611bc5c8adbd79ff8af1e34f73193",method:"transfer",args:[e,t]}})},governance:{vote:async(a,e,t,n)=>(console.log("[MockSDK] vote:",{appId:a,proposalId:e,amount:t,support:n}),await new Promise(a=>setTimeout(a,800)),{request_id:B(),user_id:"mock-user",intent:"governance",constraints:{governance:"BNEO_ONLY"},invocation:{contract:"0xc8f3bbe1c205c932aab00b28f7df99f9bc788a05",method:"vote",args:[e,t,n]}}),getCandidates:async()=>(console.log("[MockSDK] getCandidates called"),await new Promise(a=>setTimeout(a,500)),{candidates:[{address:"NNShaEBGVBfmGWzGs6W5sCneKPBwmCA3Br",publicKey:"02a1",name:"NeoEconoLabs",votes:"5000000",active:!0},{address:"NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",publicKey:"03b2",name:"COZ",votes:"4500000",active:!0},{address:"NKuyBkoGdZZSLyPbJEetheRhMjeznFZszf",publicKey:"02c3",name:"AxLabs",votes:"3200000",active:!0}],totalVotes:"12700000",blockHeight:1234567})},rng:{async requestRandom(a){console.log("[MockSDK] requestRandom:",a),await new Promise(a=>setTimeout(a,500));const e=Array.from({length:32},()=>Math.floor(256*Math.random()).toString(16).padStart(2,"0")).join("");return{request_id:B(),app_id:a,randomness:e}}},datafeed:{async getPrice(a){console.log("[MockSDK] getPrice:",a);return{feed_id:B(),pair:a,price:{"NEO-USD":"12.45","GAS-USD":"4.32","BTC-USD":"43250.00","ETH-USD":"2280.50"}[a]||"100.00",decimals:8,timestamp:(new Date).toISOString(),sources:["mock"]}}}};function $(){"undefined"!=typeof window&&(window.MiniAppSDK=V,console.log("[MockSDK] Installed on window.MiniAppSDK"),window.dispatchEvent(new Event("miniapp-sdk-ready")))}function q(){const a=Date.now()+36e5+72e5*Math.random();return{type:"live_countdown",refreshInterval:1,endTime:Math.floor(a/1e3),jackpot:(1e3+9e3*Math.random()).toFixed(2),ticketsSold:Math.floor(100+500*Math.random()),ticketPrice:"0.1"}}function O(){return{type:"live_multiplier",refreshInterval:.1,currentMultiplier:1+5*Math.random(),status:["waiting","running","crashed"][Math.floor(3*Math.random())],playersCount:Math.floor(10+50*Math.random()),totalBets:(100+900*Math.random()).toFixed(2)}}function R(){return{type:"live_canvas",refreshInterval:5,pixels:U(32,32),width:32,height:32,activeUsers:Math.floor(5+20*Math.random())}}function U(a,e){const t=["#10b981","#3b82f6","#ec4899","#f59e0b","#8b5cf6"];let n="";for(let o=0;o<a*e;o++)n+=t[Math.floor(Math.random()*t.length)].slice(1);return n}function H(){return{type:"live_stats",refreshInterval:10,stats:[{label:"Available",value:String(Math.floor(5+20*Math.random())),icon:"ðŸ§§"},{label:"Total GAS",value:(50+200*Math.random()).toFixed(1),change:12.5},{label:"Claimed",value:String(Math.floor(100+500*Math.random()))}]}}function Z(){const a=Math.floor(1e3+5e3*Math.random()),e=Math.floor(a*(.3+.5*Math.random()));return{type:"live_voting",refreshInterval:30,proposalTitle:"Increase staking rewards",yesVotes:e,noVotes:a-e,totalVotes:a,endTime:Math.floor((Date.now()+2592e5)/1e3)}}function z(){const a=10+5*Math.random();return{type:"live_price",refreshInterval:5,symbol:"NEO-USD",price:a.toFixed(2),change24h:10*Math.random()-5,sparkline:Array.from({length:24},()=>a*(.95+.1*Math.random()))}}const X=b(n({__name:"CardCountdown",props:{data:{}},setup(n){const f=n,p=a(Math.floor(Date.now()/1e3));let h;const w=t(()=>Math.max(0,f.data.endTime-p.value)),m=t(()=>String(Math.floor(w.value/3600)).padStart(2,"0")),g=t(()=>String(Math.floor(w.value%3600/60)).padStart(2,"0")),y=t(()=>String(w.value%60).padStart(2,"0")),_=t(()=>f.data.jackpot),M=t(()=>f.data.ticketsSold);return e(()=>{h=setInterval(()=>{p.value=Math.floor(Date.now()/1e3)},1e3)}),o(()=>clearInterval(h)),(a,e)=>{const t=c,n=r;return v(),l(n,{class:"card-countdown"},{default:s(()=>[i(n,{class:"countdown-timer"},{default:s(()=>[i(t,{class:"time-value"},{default:s(()=>[d(u(m.value),1)]),_:1}),i(t,{class:"time-sep"},{default:s(()=>[d(":")]),_:1}),i(t,{class:"time-value"},{default:s(()=>[d(u(g.value),1)]),_:1}),i(t,{class:"time-sep"},{default:s(()=>[d(":")]),_:1}),i(t,{class:"time-value"},{default:s(()=>[d(u(y.value),1)]),_:1})]),_:1}),i(n,{class:"jackpot"},{default:s(()=>[i(t,{class:"jackpot-label"},{default:s(()=>[d("Jackpot")]),_:1}),i(t,{class:"jackpot-value"},{default:s(()=>[d(u(_.value)+" GAS",1)]),_:1})]),_:1}),i(n,{class:"tickets"},{default:s(()=>[i(t,null,{default:s(()=>[d(u(M.value)+" tickets sold",1)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-cb3ef45a"]]),J=b(n({__name:"CardMultiplier",props:{data:{}},setup(a){const e=a,n=t(()=>e.data.currentMultiplier.toFixed(2)),o=t(()=>({waiting:"Starting...",running:"LIVE",crashed:"Crashed!"}[e.data.status]));return(a,e)=>{const t=c,p=r;return v(),l(p,{class:f(["card-multiplier",a.data.status])},{default:s(()=>[i(p,{class:"multiplier-display"},{default:s(()=>[i(t,{class:"multiplier-value"},{default:s(()=>[d(u(n.value)+"x",1)]),_:1}),i(t,{class:"status-badge"},{default:s(()=>[d(u(o.value),1)]),_:1})]),_:1}),i(p,{class:"game-info"},{default:s(()=>[i(t,null,{default:s(()=>[d(u(a.data.playersCount)+" players",1)]),_:1}),i(t,null,{default:s(()=>[d(u(a.data.totalBets)+" GAS",1)]),_:1})]),_:1})]),_:1},8,["class"])}}}),[["__scopeId","data-v-4d4c6070"]]),Y=b(n({__name:"CardCanvas",props:{data:{}},setup(t){const n=t,o=a(120);function f(){const a=h("preview-canvas"),{pixels:e,width:t,height:l}=n.data,s=o.value/t;for(let n=0;n<e.length/6;n++){const o="#"+e.slice(6*n,6*n+6),l=n%t*s,r=Math.floor(n/t)*s;a.setFillStyle(o),a.fillRect(l,r,s,s)}a.draw()}return e(()=>f()),p(()=>n.data.pixels,f),(a,e)=>{const t=w,n=r,f=c;return v(),l(n,{class:"card-canvas"},{default:s(()=>[i(n,{class:"canvas-preview"},{default:s(()=>[i(t,{"canvas-id":"preview-canvas",class:"preview-canvas",style:m({width:o.value+"px",height:o.value+"px"})},null,8,["style"])]),_:1}),i(n,{class:"canvas-info"},{default:s(()=>[i(f,{class:"active-users"},{default:s(()=>[d("ðŸŽ¨ "+u(a.data.activeUsers)+" active",1)]),_:1}),i(f,{class:"canvas-size"},{default:s(()=>[d(u(a.data.width)+"Ã—"+u(a.data.height),1)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-85b6f59e"]]),W=b(n({__name:"CardStats",props:{data:{}},setup:a=>(a,e)=>{const t=c,n=r;return v(),l(n,{class:"card-stats"},{default:s(()=>[(v(!0),g(_,null,y(a.data.stats,(a,e)=>(v(),l(n,{key:e,class:"stat-item"},{default:s(()=>[a.icon?(v(),l(t,{key:0,class:"stat-icon"},{default:s(()=>[d(u(a.icon),1)]),_:2},1024)):M("",!0),i(n,{class:"stat-content"},{default:s(()=>[i(t,{class:"stat-value"},{default:s(()=>[d(u(a.value),1)]),_:2},1024),i(t,{class:"stat-label"},{default:s(()=>[d(u(a.label),1)]),_:2},1024)]),_:2},1024),a.change?(v(),l(t,{key:1,class:f(["stat-change",a.change>0?"up":"down"])},{default:s(()=>[d(u(a.change>0?"+":"")+u(a.change.toFixed(1))+"% ",1)]),_:2},1032,["class"])):M("",!0)]),_:2},1024))),128))]),_:1})}}),[["__scopeId","data-v-c3e3c1b2"]]),Q=b(n({__name:"CardVoting",props:{data:{}},setup(a){const e=a,n=t(()=>Math.round(e.data.yesVotes/e.data.totalVotes*100)),o=t(()=>100-n.value),f=t(()=>{const a=e.data.endTime-Math.floor(Date.now()/1e3);if(a<=0)return"Ended";const t=Math.floor(a/86400);return t>0?`${t}d left`:`${Math.floor(a/3600)}h left`});return(a,e)=>{const t=c,p=r;return v(),l(p,{class:"card-voting"},{default:s(()=>[i(t,{class:"proposal-title"},{default:s(()=>[d(u(a.data.proposalTitle),1)]),_:1}),i(p,{class:"vote-bars"},{default:s(()=>[i(p,{class:"vote-bar yes"},{default:s(()=>[i(p,{class:"bar-fill",style:m({width:n.value+"%"})},null,8,["style"]),i(t,{class:"bar-label"},{default:s(()=>[d("Yes "+u(n.value)+"%",1)]),_:1})]),_:1}),i(p,{class:"vote-bar no"},{default:s(()=>[i(p,{class:"bar-fill",style:m({width:o.value+"%"})},null,8,["style"]),i(t,{class:"bar-label"},{default:s(()=>[d("No "+u(o.value)+"%",1)]),_:1})]),_:1})]),_:1}),i(p,{class:"vote-footer"},{default:s(()=>[i(t,null,{default:s(()=>[d(u(a.data.totalVotes)+" votes",1)]),_:1}),i(t,null,{default:s(()=>[d(u(f.value),1)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-ae1a2b5a"]]),aa=b(n({__name:"CardPrice",props:{data:{}},setup(a){const e=a,n=t(()=>{const{sparkline:a}=e.data,t=Math.min(...a),n=Math.max(...a)-t||1;return a.map(a=>20+(a-t)/n*80)});return(a,e)=>{const t=c,o=r;return v(),l(o,{class:"card-price"},{default:s(()=>[i(o,{class:"price-header"},{default:s(()=>[i(t,{class:"symbol"},{default:s(()=>[d(u(a.data.symbol),1)]),_:1}),i(t,{class:f(["change",a.data.change24h>=0?"up":"down"])},{default:s(()=>[d(u(a.data.change24h>=0?"+":"")+u(a.data.change24h.toFixed(2))+"% ",1)]),_:1},8,["class"])]),_:1}),i(t,{class:"price-value"},{default:s(()=>[d("$"+u(a.data.price),1)]),_:1}),i(o,{class:"sparkline"},{default:s(()=>[(v(!0),g(_,null,y(n.value,(e,t)=>(v(),l(o,{key:t,class:f(["spark-bar",a.data.change24h>=0?"up":"down"]),style:m({height:e+"%"})},null,8,["style","class"]))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-4bc5fda9"]]);export{Y as CardCanvas,X as CardCountdown,J as CardMultiplier,aa as CardPrice,W as CardStats,Q as CardVoting,I as callBridge,E as createH5Bridge,A as getSDKSync,$ as installMockSDK,R as mockCanvasData,q as mockCountdownData,O as mockMultiplierData,z as mockPriceData,V as mockSDK,H as mockStatsData,Z as mockVotingData,T as useDatafeed,F as useGasSponsor,j as useGovernance,G as useI18n,x as usePayments,L as useRNG,C as useWallet,D as waitForSDK};

import{r as a,d as e,c as l,o as t,a as s,b as u,w as i,i as n,e as r,f as c,g as o,h as d,j as v,k as p,n as f,t as m,l as _,u as g,m as w,F as y,p as h}from"./index-6b3c_vfo.js";function b(e){const l=a(!1),t=a(null);return{isLoading:l,error:t,payGAS:async(a,s)=>{l.value=!0,t.value=null;try{const l=await function(a=5e3){return new Promise((e,l)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const t=setTimeout(()=>{l(new Error("SDK timeout"))},a),s=()=>{clearTimeout(t),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):l(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await l.payments.payGAS(e,a,s)}catch(u){throw t.value=u,u}finally{l.value=!1}}}}const x=((a,e)=>{const l=a.__vccOpts||a;for(const[t,s]of e)l[t]=s;return l})(e({__name:"index",setup(e){const{payGAS:x,isLoading:A}=b("miniapp-neo-crash"),S=a("1.0"),k=a("2.0"),C=a(1),F=a("waiting"),G=a(0),M=a(null),D=a([{multiplier:1.52},{multiplier:3.21},{multiplier:1.08},{multiplier:2.45},{multiplier:1.89}]),K=l(()=>"waiting"===F.value?0:"crashed"===F.value?100:Math.min(100,20*(C.value-1))),E=l(()=>"waiting"===F.value?"Waiting for next round...":"running"===F.value?"Game in progress!":"CRASHED!"),P=l(()=>A.value?"Processing...":"waiting"===F.value?"Place Bet":"running"===F.value&&G.value>0?"Cash Out":"Wait..."),V=l(()=>G.value*C.value),B=(a,e=2)=>function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,e),j=a=>{const e=Math.max(.1,parseFloat(S.value)+a);S.value=e.toFixed(1)},L=async()=>{A.value||("waiting"===F.value?await T():"running"===F.value&&G.value>0&&W())},T=async()=>{try{M.value={msg:"Placing bet...",type:"loading"},await x(S.value,`crash:bet:${Date.now()}`),G.value=parseFloat(S.value),M.value={msg:"Bet placed! Good luck!",type:"success"}}catch(a){M.value={msg:a.message||"Error placing bet",type:"error"}}},W=()=>{const a=V.value;M.value={msg:`Cashed out at ${C.value}x! Won ${B(a)} GAS`,type:"success"},G.value=0};let I;return t(()=>{I=setInterval(()=>{"waiting"===F.value?setTimeout(()=>{F.value="running",C.value=1},3e3):"running"===F.value&&(C.value+=.05,k.value&&G.value>0&&C.value>=parseFloat(k.value)&&W(),(Math.random()<.02||C.value>10)&&(F.value="crashed",D.value.unshift({multiplier:parseFloat(C.value.toFixed(2))}),D.value=D.value.slice(0,10),G.value>0&&(M.value={msg:"Crashed! Better luck next time.",type:"error"},G.value=0),setTimeout(()=>{F.value="waiting",C.value=1},2e3)))},100)}),s(()=>clearInterval(I)),(a,e)=>{const l=v,t=n,s=r("uni-easyinput");return c(),u(t,{class:"app-container"},{default:i(()=>[o(t,{class:"header"},{default:i(()=>[o(l,{class:"title"},{default:i(()=>[p("Neo Crash")]),_:1}),o(l,{class:"subtitle"},{default:i(()=>[p("Multiplier crash game")]),_:1})]),_:1}),M.value?(c(),u(t,{key:0,class:f(["status-msg",M.value.type])},{default:i(()=>[o(l,null,{default:i(()=>[p(m(M.value.msg),1)]),_:1})]),_:1},8,["class"])):d("",!0),o(t,{class:"card multiplier-card"},{default:i(()=>[o(l,{class:f(["multiplier",F.value])},{default:i(()=>[p(m(C.value)+"x",1)]),_:1},8,["class"]),o(l,{class:"game-status"},{default:i(()=>[p(m(E.value),1)]),_:1}),o(t,{class:"progress-bar"},{default:i(()=>[o(t,{class:"progress-fill",style:_({width:K.value+"%"})},null,8,["style"])]),_:1})]),_:1}),o(t,{class:"card"},{default:i(()=>[o(l,{class:"card-title"},{default:i(()=>[p("Place Bet")]),_:1}),o(t,{class:"bet-row"},{default:i(()=>[o(l,{class:"label"},{default:i(()=>[p("Amount (GAS)")]),_:1}),o(t,{class:"input-group"},{default:i(()=>[o(t,{class:"adjust-btn",onClick:e[0]||(e[0]=a=>j(-.1))},{default:i(()=>[o(l,null,{default:i(()=>[p("-")]),_:1})]),_:1}),o(s,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=a=>S.value=a),type:"digit",class:"bet-input"},null,8,["modelValue"]),o(t,{class:"adjust-btn",onClick:e[2]||(e[2]=a=>j(.1))},{default:i(()=>[o(l,null,{default:i(()=>[p("+")]),_:1})]),_:1})]),_:1})]),_:1}),o(t,{class:"bet-row"},{default:i(()=>[o(l,{class:"label"},{default:i(()=>[p("Auto Cashout")]),_:1}),o(s,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=a=>k.value=a),type:"digit",placeholder:"2.0",class:"cashout-input"},null,8,["modelValue"])]),_:1}),o(t,{class:f(["action-btn",F.value]),onClick:L,style:_({opacity:g(A)?.6:1})},{default:i(()=>[o(l,null,{default:i(()=>[p(m(P.value),1)]),_:1})]),_:1},8,["class","style"])]),_:1}),o(t,{class:"card"},{default:i(()=>[o(l,{class:"card-title"},{default:i(()=>[p("Recent Crashes")]),_:1}),o(t,{class:"history-list"},{default:i(()=>[(c(!0),w(y,null,h(D.value,(a,e)=>(c(),u(t,{key:e,class:f(["history-item",a.multiplier>=2?"high":"low"])},{default:i(()=>[o(l,{class:"history-multiplier"},{default:i(()=>[p(m(a.multiplier)+"x",1)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1}),o(t,{class:"card stats-card"},{default:i(()=>[o(t,{class:"stat-row"},{default:i(()=>[o(l,{class:"stat-label"},{default:i(()=>[p("Your Bet")]),_:1}),o(l,{class:"stat-value"},{default:i(()=>[p(m(B(G.value))+" GAS",1)]),_:1})]),_:1}),o(t,{class:"stat-row"},{default:i(()=>[o(l,{class:"stat-label"},{default:i(()=>[p("Potential Win")]),_:1}),o(l,{class:"stat-value success"},{default:i(()=>[p(m(B(V.value))+" GAS",1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-11fdeb23"]]);export{x as default};

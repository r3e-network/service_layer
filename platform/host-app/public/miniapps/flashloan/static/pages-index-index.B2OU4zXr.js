import{r as a,d as e,c as t,w as l,i as s,a as n,o as u,b as o,e as i,f as r,g as d,n as c,t as f,u as p}from"./index-CiYlf1oN.js";function v(e){const t=a(!1),l=a(null);return{isLoading:t,error:l,payGAS:async(a,s)=>{t.value=!0,l.value=null;try{const t=await function(a=5e3){return new Promise((e,t)=>{if(window.MiniAppSDK)return void e(window.MiniAppSDK);const l=setTimeout(()=>{t(new Error("SDK timeout"))},a),s=()=>{clearTimeout(l),window.removeEventListener("miniapp-sdk-ready",s),window.MiniAppSDK?e(window.MiniAppSDK):t(new Error("SDK not found"))};window.addEventListener("miniapp-sdk-ready",s)})}();return await t.payments.payGAS(e,a,s)}catch(n){throw l.value=n,n}finally{t.value=!1}}}}const _=((a,e)=>{const t=a.__vccOpts||a;for(const[l,s]of e)t[l]=s;return t})(e({__name:"index",setup(e){const{payGAS:_,isLoading:m}=v("miniapp-flashloan"),w=a(5e4),y=a(1e3),A=a(""),F=a(null),S=async()=>{if(m.value)return;const a=parseFloat(A.value);if(a<=0||a>w.value)F.value={msg:"Invalid amount",type:"error"};else try{const e=(9e-4*a).toFixed(4);await _(e,`flashloan:${a}`),F.value={msg:`Flash loan executed: ${a} GAS`,type:"success"}}catch(e){F.value={msg:e.message||"Error",type:"error"}}};return(a,e)=>{const v=r,_=s,h=n("uni-easyinput");return u(),t(_,{class:"app-container"},{default:l(()=>[o(_,{class:"header"},{default:l(()=>[o(v,{class:"title"},{default:l(()=>[d("Flash Loan")]),_:1}),o(v,{class:"subtitle"},{default:l(()=>[d("Instant uncollateralized loans")]),_:1})]),_:1}),F.value?(u(),t(_,{key:0,class:c(["status-msg",F.value.type])},{default:l(()=>[o(v,null,{default:l(()=>[d(f(F.value.msg),1)]),_:1})]),_:1},8,["class"])):i("",!0),o(_,{class:"card"},{default:l(()=>[o(v,{class:"card-title"},{default:l(()=>[d("Available Liquidity")]),_:1}),o(_,{class:"liquidity-row"},{default:l(()=>[o(v,{class:"token"},{default:l(()=>[d("GAS")]),_:1}),o(v,{class:"amount"},{default:l(()=>{return[d(f((a=w.value,function(a,e=2){return a>=1e6?(a/1e6).toFixed(e)+"M":a>=1e3?(a/1e3).toFixed(e)+"K":a.toFixed(e)}(a,0))),1)];var a}),_:1})]),_:1}),o(_,{class:"liquidity-row"},{default:l(()=>[o(v,{class:"token"},{default:l(()=>[d("NEO")]),_:1}),o(v,{class:"amount"},{default:l(()=>[d(f(y.value),1)]),_:1})]),_:1})]),_:1}),o(_,{class:"card"},{default:l(()=>[o(v,{class:"card-title"},{default:l(()=>[d("Request Flash Loan")]),_:1}),o(h,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a),type:"number",placeholder:"Amount"},null,8,["modelValue"]),o(_,{class:"fee-row"},{default:l(()=>[o(v,null,{default:l(()=>[d("Fee (0.09%)")]),_:1}),o(v,{class:"fee"},{default:l(()=>[d(f((9e-4*parseFloat(A.value||"0")).toFixed(4))+" GAS",1)]),_:1})]),_:1}),o(_,{class:"action-btn",onClick:S},{default:l(()=>[o(v,null,{default:l(()=>[d(f(p(m)?"Processing...":"Execute Flash Loan"),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-910e9c5a"]]);export{_ as default};

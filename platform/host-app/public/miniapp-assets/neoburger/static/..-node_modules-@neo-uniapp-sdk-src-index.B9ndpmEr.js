import{t as e,w as t,a as n,b as a,c as o}from"./index.G1KKzTkz.js";import{d as r,e as s,f as i,g as c,h as l,i as d,r as u,j as g,s as m,u as p,k as v}from"./index.G1KKzTkz.js";import{q as h,o as w}from"./index-DekwACdn.js";import"./NeoDoc.BOn2zV6Q.js";function f(t){const n=h(!1),a=h(null);return{isLoading:n,error:a,execute:async(...o)=>{n.value=!0,a.value=null;try{return await t(...o)}catch(r){throw a.value=e(r),r}finally{n.value=!1}}}}function y(e){const{isLoading:n,error:a,execute:o}=f(async(n,a)=>{const o=parseFloat(n);if(Number.isNaN(o)||o<=0)throw new Error("Invalid amount: must be a positive number");const r=await t();return r.payments.payGASAndInvoke?await r.payments.payGASAndInvoke(e,n,a):await r.payments.payGAS(e,n,a)});return{isLoading:n,error:a,payGAS:o}}function S(e){const n=f(async(n,a,o)=>{if(!n||"string"!=typeof n)throw new Error("Invalid proposalId: must be a non-empty string");const r=parseFloat(a);if(Number.isNaN(r)||r<=0)throw new Error("Invalid amount: must be a positive number");const s=await t();return await s.governance.vote(e,n,a,o)}),a=f(async()=>{const e=await t();return await e.governance.getCandidates()});return{isVoting:n.isLoading,voteError:n.error,vote:n.execute,isLoadingCandidates:a.isLoading,candidatesError:a.error,getCandidates:a.execute}}function _(e){if(!e||"string"!=typeof e)throw new Error("useRNG: appId is required and must be a non-empty string");const{isLoading:n,error:a,execute:o}=f(async()=>{const n=await t();return await n.rng.requestRandom(e)});return{isLoading:n,error:a,requestRandom:o}}function b(){const e=f(async e=>{if(!e||"string"!=typeof e)throw new Error("getPrice: symbol is required and must be a non-empty string");const n=await t();return await n.datafeed.getPrice(e)}),n=f(async()=>{var e;const n=await t();if(!(null==(e=n.datafeed)?void 0:e.getPrices))throw new Error("datafeed.getPrices not available");return await n.datafeed.getPrices()}),a=f(async()=>{var e;const n=await t();if(!(null==(e=n.datafeed)?void 0:e.getNetworkStats))throw new Error("datafeed.getNetworkStats not available");return await n.datafeed.getNetworkStats()}),o=f(async e=>{var n;const a=await t();if(!(null==(n=a.datafeed)?void 0:n.getRecentTransactions))throw new Error("datafeed.getRecentTransactions not available");return await a.datafeed.getRecentTransactions(e)});return{isLoading:e.isLoading,error:e.error,getPrice:e.execute,isLoadingPrices:n.isLoading,pricesError:n.error,getPrices:n.execute,isLoadingNetworkStats:a.isLoading,networkStatsError:a.error,getNetworkStats:a.execute,isLoadingRecentTransactions:o.isLoading,recentTransactionsError:o.error,getRecentTransactions:o.execute}}function k(){const e=f(async(e={})=>{var n;const a=await t();if(!(null==(n=a.events)?void 0:n.list))throw new Error("events.list not available");return await a.events.list(e)}),n=f(async(e,n)=>{var a;const o=String(e||"").trim();if(!o)throw new Error("eventName required");const r=await t();if(!(null==(a=r.events)?void 0:a.emit))throw new Error("events.emit not available");return await r.events.emit(o,n||{})});return{isLoading:e.isLoading,error:e.error,list:e.execute,isEmitting:n.isLoading,emitError:n.error,emit:n.execute}}function M(){const e=f(async()=>a("/gas-sponsor-check")),t=f(async e=>{const t=parseFloat(e);if(Number.isNaN(t)||t<=0)throw new Error("Invalid amount: must be a positive number");return n("/gas-sponsor-request",{amount:e})});return{isCheckingEligibility:e.isLoading,eligibilityError:e.error,checkEligibility:e.execute,isRequestingSponsorship:t.isLoading,sponsorshipError:t.error,requestSponsorship:t.execute}}function D(n={}){const{slot:r="default",autoLoad:s=!1}=n,i=h([]),c=h(null),l=h(!1),d=h(!1),u=h(!1),g=h(null),m=h(null),p=async n=>{var o;l.value=!0,g.value=null;try{const e=await t(),s=(null==(o=e.getConfig)?void 0:o.call(e).appId)||"unknown",l=await a(`/api/miniapps/${s}/cloud-saves`);i.value=(null==l?void 0:l.saves)||[];const d=n||r;return c.value=i.value.find(e=>e.slot_name===d)||null,m.value=new Date,c.value}catch(s){return g.value=e(s),null}finally{l.value=!1}};return w(()=>{s&&p()}),{saves:i,currentSave:c,isLoading:l,isSaving:d,isDeleting:u,error:g,lastSyncedAt:m,load:p,save:async(n,a)=>{var s;d.value=!0,g.value=null;try{const e=await t(),i=(null==(s=e.getConfig)?void 0:s.call(e).appId)||"unknown",l=await o(`/api/miniapps/${i}/cloud-saves`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slot_name:a||r,save_data:n,client_timestamp:(new Date).toISOString()})});return c.value=l.save,m.value=new Date,!0}catch(i){return g.value=e(i),!1}finally{d.value=!1}},deleteSave:async n=>{var a,s;u.value=!0,g.value=null;try{const e=await t(),l=(null==(a=e.getConfig)?void 0:a.call(e).appId)||"unknown";return await o(`/api/miniapps/${l}/cloud-saves`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({slot_name:n||r})}),i.value=i.value.filter(e=>e.slot_name!==(n||r)),(null==(s=c.value)?void 0:s.slot_name)===(n||r)&&(c.value=null),!0}catch(l){return g.value=e(l),!1}finally{u.value=!1}}}}const x=()=>`mock-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,E={invoke:async(e,...t)=>(console.log("[MockSDK] invoke:",e,t),{}),getConfig:()=>({appId:"mock-app",contractAddress:null,debug:!0}),wallet:{getAddress:async()=>(console.log("[MockSDK] getAddress called"),"NXV7ZhHiyM1aHXwpVsRZC6BwNFP2jghXAq"),async switchChain(e){console.log("[MockSDK] switchChain called:",e)},async signMessage(e){return console.log("[MockSDK] signMessage:",e),`mock-signature-${(t=e,"function"==typeof btoa?btoa(t):"undefined"!=typeof Buffer?Buffer.from(t,"utf8").toString("base64"):t).slice(0,12)}`;var t},invokeIntent:async e=>(console.log("[MockSDK] invokeIntent:",e),{txid:x()})},payments:{async payGAS(e,t,n){console.log("[MockSDK] payGAS:",{appId:e,amount:t,memo:n}),await new Promise(e=>setTimeout(e,800));const a=x();return{request_id:a,receipt_id:a,user_id:"mock-user",intent:"payments",constraints:{settlement:"GAS_ONLY"},chain_id:"neo-n3-mainnet",chain_type:"neo-n3",invocation:{chain_id:"neo-n3-mainnet",chain_type:"neo-n3",contract_address:"0x0bb8f09e6d3611bc5c8adbd79ff8af1e34f73193",method:"transfer",params:[t,n??""]}}},async payGASAndInvoke(e,t,n){return{...await this.payGAS(e,t,n),txid:x()}}},governance:{vote:async(e,t,n,a)=>(console.log("[MockSDK] vote:",{appId:e,proposalId:t,amount:n,support:a}),await new Promise(e=>setTimeout(e,800)),{request_id:x(),user_id:"mock-user",intent:"governance",constraints:{governance:"BNEO_ONLY"},chain_id:"neo-n3-mainnet",chain_type:"neo-n3",invocation:{chain_id:"neo-n3-mainnet",chain_type:"neo-n3",contract_address:"0xc8f3bbe1c205c932aab00b28f7df99f9bc788a05",method:"vote",params:[t,n,a]}}),async voteAndInvoke(e,t,n,a){return{...await this.vote(e,t,n,a),txid:x()}},getCandidates:async()=>(console.log("[MockSDK] getCandidates called"),await new Promise(e=>setTimeout(e,500)),{candidates:[{address:"NNShaEBGVBfmGWzGs6W5sCneKPBwmCA3Br",publicKey:"02a1",name:"NeoEconoLabs",votes:"5000000",active:!0},{address:"NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",publicKey:"03b2",name:"COZ",votes:"4500000",active:!0},{address:"NKuyBkoGdZZSLyPbJEetheRhMjeznFZszf",publicKey:"02c3",name:"AxLabs",votes:"3200000",active:!0}],totalVotes:"12700000",blockHeight:1234567})},rng:{async requestRandom(e){console.log("[MockSDK] requestRandom:",e),await new Promise(e=>setTimeout(e,500));const t=Array.from({length:32},()=>Math.floor(256*Math.random()).toString(16).padStart(2,"0")).join("");return{request_id:x(),app_id:e,chain_id:"neo-n3-mainnet",chain_type:"neo-n3",randomness:t}}},datafeed:{async getPrice(e){console.log("[MockSDK] getPrice:",e);return{feed_id:x(),pair:e,price:{"NEO-USD":"12.45","GAS-USD":"4.32","BTC-USD":"43250.00","ETH-USD":"2280.50"}[e]||"100.00",decimals:8,timestamp:(new Date).toISOString(),sources:["mock"]}},getPrices:async()=>(console.log("[MockSDK] getPrices called"),{neo:{usd:12.45,usd_24h_change:1.2},gas:{usd:4.32,usd_24h_change:-.4},timestamp:Date.now()}),getNetworkStats:async()=>(console.log("[MockSDK] getNetworkStats called"),{blockHeight:1234567,validatorCount:7,network:"neo-n3-mainnet",version:"mock-1.0"}),async getRecentTransactions(e=10){console.log("[MockSDK] getRecentTransactions called:",e);const t=Math.max(1,Math.min(e,5));return{blockHeight:1234567,transactions:Array.from({length:t},()=>({txid:x(),blockHeight:1234567,blockTime:Date.now(),sender:"NQiQvS9s5XbPpKXt9g6z4yUaqE8h4PGnRy",size:123,sysfee:"0.1",netfee:"0.01"}))}}},events:{async list(e={}){console.log("[MockSDK] events.list:",e),await new Promise(e=>setTimeout(e,300));const t=x();return{events:[{id:t,app_id:e.app_id||"mock-app",event_name:e.event_name||"MockEvent",chain_id:e.chain_id||"neo-n3-mainnet",contract_address:"0x0000000000000000000000000000000000000000",tx_hash:`0x${x()}`,block_index:1234567,state:[],created_at:(new Date).toISOString()}],has_more:!1,last_id:t}}},transactions:{async list(e={}){console.log("[MockSDK] transactions.list:",e),await new Promise(e=>setTimeout(e,300));const t=x();return{transactions:[{id:t,tx_hash:`0x${t}`,request_id:x(),from_service:"mock",tx_type:"contract",chain_id:e.chain_id||"neo-n3-mainnet",contract_address:"0x0000000000000000000000000000000000000000",method_name:"transfer",params:{},gas_consumed:.1,status:"confirmed",retry_count:0,error_message:null,rpc_endpoint:null,submitted_at:(new Date).toISOString(),confirmed_at:(new Date).toISOString()}],has_more:!1,last_id:t}}},stats:{getMyUsage:async(e,t)=>(console.log("[MockSDK] stats.getMyUsage:",{appId:e,date:t}),await new Promise(e=>setTimeout(e,300)),{app_id:e,chain_id:"neo-n3-mainnet",date:t||(new Date).toISOString().split("T")[0],transactions:42,volume_gas:"123.45",unique_users:10})}};function I(){"undefined"!=typeof window&&(window.MiniAppSDK=E,console.log("[MockSDK] Installed on window.MiniAppSDK"),window.dispatchEvent(new Event("miniapp-sdk-ready")))}function L(){const e=Date.now()+36e5+72e5*Math.random();return{type:"live_countdown",refreshInterval:1,endTime:Math.floor(e/1e3),jackpot:(1e3+9e3*Math.random()).toFixed(2),ticketsSold:Math.floor(100+500*Math.random()),ticketPrice:"0.1"}}function N(){return{type:"live_multiplier",refreshInterval:.1,currentMultiplier:1+5*Math.random(),status:["waiting","running","crashed"][Math.floor(3*Math.random())],playersCount:Math.floor(10+50*Math.random()),totalBets:(100+900*Math.random()).toFixed(2)}}function A(){return{type:"live_canvas",refreshInterval:5,pixels:T(32,32),width:32,height:32,activeUsers:Math.floor(5+20*Math.random())}}function T(e,t){const n=["#10b981","#3b82f6","#ec4899","#f59e0b","#8b5cf6"];let a="";for(let o=0;o<e*t;o++)a+=n[Math.floor(Math.random()*n.length)].slice(1);return a}function P(){return{type:"live_stats",refreshInterval:10,stats:[{label:"Available",value:String(Math.floor(5+20*Math.random())),icon:"ðŸ§§"},{label:"Total GAS",value:(50+200*Math.random()).toFixed(1),change:12.5},{label:"Claimed",value:String(Math.floor(100+500*Math.random()))}]}}function K(){const e=Math.floor(1e3+5e3*Math.random()),t=Math.floor(e*(.3+.5*Math.random()));return{type:"live_voting",refreshInterval:30,proposalTitle:"Increase staking rewards",yesVotes:t,noVotes:e-t,totalVotes:e,endTime:Math.floor((Date.now()+2592e5)/1e3)}}function C(){const e=10+5*Math.random();return{type:"live_price",refreshInterval:5,symbol:"NEO-USD",price:e.toFixed(2),change24h:10*Math.random()-5,sparkline:Array.from({length:24},()=>e*(.95+.1*Math.random()))}}function q(){const e=new AbortController;return{signal:e.signal,cancel:()=>e.abort(),isCancelled:()=>e.signal.aborted}}class G{constructor(){this.controllers=new Map}create(e){this.cancel(e);const t=new AbortController;return this.controllers.set(e,t),t.signal}cancel(e){const t=this.controllers.get(e);t&&(t.abort(),this.controllers.delete(e))}cancelAll(){for(const e of this.controllers.values())e.abort();this.controllers.clear()}isPending(e){const t=this.controllers.get(e);return!!t&&!t.signal.aborted}}const R=new G;export{G as RequestManager,o as apiFetch,a as apiGet,n as apiPost,r as callBridge,s as cleanupWalletStateListener,q as createCancellableRequest,i as createH5Bridge,c as getSDKSync,l as getWalletState,d as initWalletStateListener,I as installMockSDK,A as mockCanvasData,L as mockCountdownData,N as mockMultiplierData,C as mockPriceData,E as mockSDK,P as mockStatsData,K as mockVotingData,R as requestManager,u as resetI18nState,g as resolveLayout,m as subscribeToWalletState,f as useAsyncAction,D as useCloudSaves,b as useDatafeed,k as useEvents,M as useGasSponsor,S as useGovernance,p as useI18n,y as usePayments,_ as useRNG,v as useWallet,t as waitForSDK};

import{r as e,a,o as t,b as n,c as l,d as s,e as i,f as o,i as r,w as c,g as d,h as u,j as v,t as h,k as f,u as w,n as p,l as g,m as y,p as m,F as b,q as _,s as k,v as C}from"./index-BeXYbzoF.js";import{A as x,s as I,w as A,g as E,a as T,_ as S}from"./Fireworks.vue_vue_type_style_index_0_scoped_4da74fd1_lang.DMBoUrEB.js";import{_ as M}from"./NeoDoc.vue_vue_type_style_index_0_scoped_445ca862_lang.EGIHekIB.js";import{u as $,N}from"./useI18n.B-m8n-PK.js";const D={maxRetries:3,baseDelayMs:1e3,maxDelayMs:1e4};function R(e,a){return Math.min(a.baseDelayMs*Math.pow(2,e),a.maxDelayMs)*(.75+.5*Math.random())}function j(e,a){if(e instanceof Error){const a=e.message.toLowerCase();return a.includes("network")||a.includes("timeout")||a.includes("abort")}return!1}async function F(a,t){var n;if("undefined"!=typeof uni&&"function"==typeof e)return new Promise((n,l)=>{const s=(e=>{if(e){if(e instanceof Headers){const a={};return e.forEach((e,t)=>{a[t]=e}),a}return Array.isArray(e)?Object.fromEntries(e):e}})(t.headers),i=String((null==s?void 0:s["Content-Type"])||(null==s?void 0:s["content-type"])||"");let o=t.body;if("string"==typeof o&&i.includes("application/json"))try{o=JSON.parse(o)}catch{}e({url:a,method:t.method||"GET",data:o,header:s,success:e=>{var a,t;if((e.statusCode??0)>=200&&(e.statusCode??0)<300)n(e.data);else{const n=(null==(t=null==(a=e.data)?void 0:a.error)?void 0:t.message)||`Request failed: ${e.statusCode}`;l(new Error(n))}},fail:e=>{l(new Error(e.errMsg||"Network error"))}})});const l=await fetch(a,{credentials:"include",...t});if(!l.ok){const e=await l.json().catch(()=>({}));throw new Error((null==(n=e.error)?void 0:n.message)||`Request failed: ${a}`)}return l.json()}async function q(e){return async function(e,a={}){var t,n;const l=e.startsWith("http")?e:`${x}${e}`,s={...D,...a.retryConfig};let i=null;for(let r=0;r<=s.maxRetries;r++){if(null==(t=a.signal)?void 0:t.aborted)throw new Error("Request cancelled");try{return await F(l,a)}catch(o){if(i=o instanceof Error?o:new Error(String(o)),null==(n=a.signal)?void 0:n.aborted)throw i;if(r>=s.maxRetries)break;if(!j(o))break;const e=R(r,s);await new Promise(a=>setTimeout(a,e))}}throw i||new Error("Request failed")}(e,{method:"GET"})}let B=null,L=null;function W(){const e=a(null),l=a({}),s=a(null),i=a(null),o=a(null),r=a([]),c=a(!1),d=a(!1),u=a(null),v=a(!1),h=a(null),f=a=>{a.connected&&a.address?(e.value=a.address,c.value=!0):(e.value=null,c.value=!1),s.value=a.chainId??null,i.value=a.chainType??null,l.value=(e=>{if(!e)return{};if(e.balances&&Object.keys(e.balances).length>0)return{...e.balances};if(e.balance){const a={};return a[e.balance.nativeSymbol||("neo-n3"===e.chainType?"GAS":"NATIVE")]=e.balance.native||"0",(e.balance.governance||e.balance.governanceSymbol)&&(a[e.balance.governanceSymbol||("neo-n3"===e.chainType?"NEO":"GOV")]=e.balance.governance||"0"),a}return{}})(a)},w=e=>{e&&(o.value=e.chainId??null,r.value=Array.isArray(e.supportedChains)?e.supportedChains:[])},p=async()=>{var e;const a=await A(),t=null==(e=a.getConfig)?void 0:e.call(a);return w(t),t},g=async e=>{const a=await A();if(!a.wallet.switchChain)throw new Error("switchChain not supported by SDK");await a.wallet.switchChain(e),s.value=e};let y=null;return t(()=>{const a=T();f(a),y=I(e=>{f(e)});const t=E();if((null==t?void 0:t.getConfig)&&w(t.getConfig()),t&&!c.value){const a=c.value,n=n=>{var l;if(!a&&!c.value){e.value=n,c.value=!0;const a=null==(l=t.getConfig)?void 0:l.call(t);s.value=(null==a?void 0:a.chainId)??null,i.value=(null==a?void 0:a.chainType)??null,w(a)}};L?n(L):(B||(B=t.wallet.getAddress().then(e=>(L=e,e))),B.then(e=>n(e)).catch(e=>{B=null,console.debug("[MiniApp SDK] Fallback wallet connection failed:",(null==e?void 0:e.message)||e)}))}A().then(e=>{var a;return w(null==(a=e.getConfig)?void 0:a.call(e))}).catch(()=>{})}),n(()=>{y&&y()}),{address:e,chainId:s,chainType:i,appChainId:o,supportedChains:r,balances:l,isConnected:c,isLoading:d,error:u,showConnectionPrompt:v,connectionPromptMessage:h,connect:async()=>{var a;d.value=!0,u.value=null;try{const t=await A();e.value=await t.wallet.getAddress(),c.value=!0;const n=null==(a=t.getConfig)?void 0:a.call(t);s.value=(null==n?void 0:n.chainId)??null,i.value=(null==n?void 0:n.chainType)??null,w(n)}catch(t){u.value=t}finally{d.value=!1}},invokeIntent:async e=>{var a;const t=E();if(!(null==(a=null==t?void 0:t.wallet)?void 0:a.invokeIntent))throw new Error("invokeIntent not available");return t.wallet.invokeIntent(e)},invokeContract:async e=>{var a;const t=await A(),n=null==(a=t.getConfig)?void 0:a.call(t),l=e.contractAddress||e.scriptHash||e.contractHash,s=e.method||e.operation;if(!l||!s)throw new Error("contract address and method required");return t.invoke("invokeFunction",{contract:l,method:s,args:e.args,chainId:null==n?void 0:n.chainId,chainType:null==n?void 0:n.chainType})},invokeRead:async e=>{var a;const t=await A(),n=null==(a=t.getConfig)?void 0:a.call(t),l=e.contractAddress||e.scriptHash||e.contractHash||(null==n?void 0:n.contractAddress),s=e.method||e.operation;if(!l)throw new Error("contract address not configured");if(!s)throw new Error("method required");return t.invoke("invokeRead",{contract:l,method:s,args:e.args||[],chainId:e.chainId||(null==n?void 0:n.chainId),chainType:e.chainType||(null==n?void 0:n.chainType)})},getContractAddress:async()=>{var e,a,t,n,l;const s=await A(),i=null==(e=s.getConfig)?void 0:e.call(s);if(null==i?void 0:i.contractAddress)return i.contractAddress;if((null==i?void 0:i.chainId)&&(null==(t=null==(a=null==i?void 0:i.chainContracts)?void 0:a[i.chainId])?void 0:t.address))return i.chainContracts[i.chainId].address||null;if(s.invoke)try{const e=await s.invoke("getConfig");if(null==e?void 0:e.contractAddress)return e.contractAddress;if((null==e?void 0:e.chainId)&&(null==(l=null==(n=null==e?void 0:e.chainContracts)?void 0:n[e.chainId])?void 0:l.address))return e.chainContracts[e.chainId].address||null}catch{}return null},getAppConfig:p,getAddress:async()=>(await A()).wallet.getAddress(),signMessage:async e=>{var a;const t=await A();if(!(null==(a=t.wallet)?void 0:a.signMessage))throw new Error("signMessage not available");return t.wallet.signMessage(e)},switchChain:g,switchToAppChain:async e=>{const a=await p(),t=(null==a?void 0:a.chainId)||(Array.isArray(null==a?void 0:a.supportedChains)&&a.supportedChains.length>0?a.supportedChains[0]:null)||e||null;if(!t)throw new Error("app chain not configured");await g(t)},getBalance:async e=>{var a;d.value=!0,u.value=null;try{const t=await A(),n=null==(a=t.getConfig)?void 0:a.call(t),i=(null==n?void 0:n.chainId)||s.value,o=i?`?chain_id=${encodeURIComponent(i)}`:"",r=await q(`/wallet-balance${o}`),c=(null==r?void 0:r.balances)??{};return l.value=c,e?c[e]||"0":c}catch(t){throw u.value=t,t}finally{d.value=!1}},getTransactions:async(e=20)=>{var a;d.value=!0,u.value=null;try{const t=Number.isNaN(e)||e<1?20:Math.min(e,100),n=await A(),l=null==(a=n.getConfig)?void 0:a.call(n),i=(null==l?void 0:l.chainId)||s.value,o=new URLSearchParams({limit:String(t)});i&&o.set("chain_id",i);return(await q(`/wallet-transactions?${o.toString()}`)).transactions}catch(t){throw u.value=t,t}finally{d.value=!1}},invoke:async(e,a)=>(await A()).invoke(e,a),requireConnection:(e={})=>{const{showPrompt:a=!0,errorMessage:t}=e;return!!c.value||(a&&(h.value=t||null,v.value=!0),!1)},closeConnectionPrompt:()=>{v.value=!1,h.value=null},clearError:()=>{u.value=null}}}const P=M(s({__name:"ChainWarning",props:{title:{default:"Wrong Network"},message:{default:"Switch to Neo N3 Mainnet to continue."},buttonText:{default:"Switch Network"},show:{type:Boolean,default:void 0}},emits:["switch","switch-complete","switch-error"],setup(e,{emit:t}){const n=e,s=t,{showWarning:p,switchToAppChain:g}=function(){const{switchToAppChain:e}=W();return{showWarning:l(()=>!1),switchToAppChain:async()=>{try{await e()}catch(a){throw console.error("[useChainValidation] Failed to switch chain:",a),a}}}}(),y=a(!1),m=l(()=>void 0!==n.show?n.show:p.value),b=async()=>{if(!y.value){y.value=!0,s("switch");try{await g(),s("switch-complete")}catch(e){const a=e instanceof Error?e:new Error(String(e));s("switch-error",a),console.error("[ChainWarning] Failed to switch chain:",a)}finally{y.value=!1}}};return(e,a)=>{const t=u,n=r;return m.value?(i(),o(n,{key:0,class:"chain-warning px-4 mb-4"},{default:c(()=>[d(w(z),{variant:"danger"},{default:c(()=>[d(n,{class:"flex flex-col items-center gap-2 py-1"},{default:c(()=>[d(t,{class:"text-center font-bold text-red-400"},{default:c(()=>[v(h(e.title),1)]),_:1}),e.message?(i(),o(t,{key:0,class:"text-xs text-center opacity-80 text-white"},{default:c(()=>[v(h(e.message),1)]),_:1})):f("",!0),d(w(H),{size:"sm",variant:"secondary",class:"mt-2",loading:y.value,onClick:b},{default:c(()=>[v(h(e.buttonText),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})):f("",!0)}}}),[["__scopeId","data-v-3dc811c7"]]),z=M(s({__name:"NeoCard",props:{title:{default:void 0},variant:{default:"default"},hoverable:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},emits:["click"],setup:e=>(e,a)=>{const t=u,n=r;return i(),o(n,{class:p(["neo-card",`neo-card--${e.variant}`,{"neo-card--hoverable":e.hoverable,"neo-card--flat":e.flat}]),onClick:a[0]||(a[0]=a=>e.hoverable&&e.$emit("click",a))},{default:c(()=>[e.title||e.$slots.header?(i(),o(n,{key:0,class:"neo-card__header"},{default:c(()=>[e.title?(i(),o(t,{key:0,class:"neo-card__title"},{default:c(()=>[v(h(e.title),1)]),_:1})):f("",!0),g(e.$slots,"header",{},void 0,!0)]),_:3})):f("",!0),d(n,{class:"neo-card__body"},{default:c(()=>[g(e.$slots,"default",{},void 0,!0)]),_:3}),e.$slots.footer?(i(),o(n,{key:1,class:"neo-card__footer"},{default:c(()=>[g(e.$slots,"footer",{},void 0,!0)]),_:3})):f("",!0)]),_:3},8,["class"])}}),[["__scopeId","data-v-8c9297aa"]]),H=M(s({__name:"NeoButton",props:{variant:{default:"primary"},size:{default:"md"},block:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},ariaLabel:{default:void 0}},emits:["click"],setup:e=>(e,a)=>{const t=r,n=y;return i(),o(n,{class:p(["neo-btn",`neo-btn--${e.variant}`,`neo-btn--${e.size}`,{"neo-btn--block":e.block,"neo-btn--loading":e.loading}]),disabled:e.disabled||e.loading,"aria-busy":e.loading,"aria-disabled":e.disabled||e.loading,"aria-label":e.ariaLabel,onClick:a[0]||(a[0]=a=>e.$emit("click",a))},{default:c(()=>[e.loading?(i(),o(t,{key:0,class:"neo-btn__spinner"})):g(e.$slots,"default",{key:1},void 0,!0)]),_:3},8,["class","disabled","aria-busy","aria-disabled","aria-label"])}}),[["__scopeId","data-v-d9647ea1"]]),O=M(s({__name:"index",setup(e){const s=a(window.innerWidth);l(()=>s.value<768),l(()=>s.value>=1024);const p=()=>{s.value=window.innerWidth};t(()=>window.addEventListener("resize",p)),n(()=>window.removeEventListener("resize",p));const{t:g}=$(),y=l(()=>[{id:"news",icon:"news",label:g("news")},{id:"docs",icon:"book",label:g("docs")}]),x=a("news"),I=l(()=>[g("step1"),g("step2"),g("step3"),g("step4")]),A=l(()=>[{name:g("feature1Name"),desc:g("feature1Desc")},{name:g("feature2Name"),desc:g("feature2Desc")}]),E=a(!0),T=a([]),M=a("");function D(e){if(!e)return"";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}return t(async()=>{await async function(){E.value=!0,M.value="";try{const e=await fetch("/api/nnt-news?limit=20");if(!e.ok)throw new Error(g("loadFailed"));const a=await e.json(),t=Array.isArray(a.articles)?a.articles:[];T.value=t.map(e=>({id:String(e.id||""),title:String(e.title||""),excerpt:String(e.summary||e.excerpt||""),date:String(e.pubDate||e.date||""),image:e.imageUrl||e.image||void 0,url:String(e.link||e.url||"")})).filter(e=>e.id&&e.title&&e.url)}catch(e){T.value=[],M.value=g("loadFailed")}finally{E.value=!1}}()}),(e,a)=>{const t=u,n=r,l=k;return i(),o(w(S),{"desktop-breakpoint":1024,tabs:y.value,"active-tab":x.value,onTabChange:a[0]||(a[0]=e=>x.value=e),"\x3c!--":"",Desktop:"",Sidebar:"","--":""},{"desktop-sidebar":c(()=>[d(n,{class:"desktop-sidebar"},{default:c(()=>[d(t,{class:"sidebar-title"},{default:c(()=>[v(h(w(g)("overview")),1)]),_:1})]),_:1})]),default:c(()=>[v(" > "),d(w(P),{title:w(g)("wrongChain"),message:w(g)("wrongChainMessage"),"button-text":w(g)("switchToNeo")},null,8,["title","message","button-text"]),"news"===x.value?(i(),o(n,{key:0,class:"nnt-container theme-neo-news"},{default:c(()=>[E.value?(i(),o(n,{key:0,class:"nnt-loading"},{default:c(()=>[d(n,{class:"nnt-spinner"}),d(t,{class:"nnt-loading-text"},{default:c(()=>[v(h(w(g)("loading")),1)]),_:1})]),_:1})):(i(),o(n,{key:1,class:"nnt-articles"},{default:c(()=>[M.value?(i(),o(w(z),{key:0,variant:"danger",class:"nnt-empty-card"},{default:c(()=>[d(t,{class:"nnt-empty-text"},{default:c(()=>[v(h(M.value),1)]),_:1})]),_:1})):(i(),m(b,{key:1},[(i(!0),m(b,null,_(T.value,e=>(i(),o(w(z),{key:e.id,variant:"erobo",class:"nnt-article-card",onClick:a=>function(e){const a=e.url;a&&C({url:`/pages/detail/index?url=${encodeURIComponent(a)}`})}(e)},{default:c(()=>[d(n,{class:"article-inner"},{default:c(()=>[e.image?(i(),o(l,{key:0,src:e.image,class:"nnt-article-image",mode:"aspectFill",alt:e.title||w(g)("articleImage")},null,8,["src","alt"])):f("",!0),d(n,{class:"nnt-article-content"},{default:c(()=>[d(t,{class:"nnt-article-title-glass"},{default:c(()=>[v(h(e.title),1)]),_:2},1024),d(n,{class:"nnt-meta mb-2"},{default:c(()=>[d(t,{class:"nnt-article-date-glass"},{default:c(()=>[v(h(D(e.date)),1)]),_:2},1024)]),_:2},1024),d(t,{class:"nnt-article-excerpt-glass"},{default:c(()=>[v(h(e.excerpt),1)]),_:2},1024),d(n,{class:"read-more mt-3"},{default:c(()=>[d(t,{class:"read-more-text"},{default:c(()=>[v(h(w(g)("readMore"))+" â†’",1)]),_:1})]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),0===T.value.length?(i(),o(w(z),{key:0,variant:"erobo",class:"nnt-empty-card"},{default:c(()=>[d(t,{class:"nnt-empty-text"},{default:c(()=>[v(h(w(g)("noArticles")),1)]),_:1})]),_:1})):f("",!0)],64))]),_:1}))]),_:1})):f("",!0),"docs"===x.value?(i(),o(n,{key:1,class:"tab-content scrollable"},{default:c(()=>[d(w(N),{title:w(g)("title"),subtitle:w(g)("docSubtitle"),description:w(g)("docDescription"),steps:I.value,features:A.value},null,8,["title","subtitle","description","steps","features"])]),_:1})):f("",!0)]),_:1},8,["tabs","active-tab"])}}}),[["__scopeId","data-v-e49f1c88"]]);export{O as default};

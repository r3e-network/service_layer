import{u as e,w as t,a as n,b as a,t as o,c as s}from"./index.BTIaUOvz.js";import{d as r,e as i,f as c,g as l,h as d,i as u,r as m,j as p,s as g,k as v,l as h,m as f}from"./index.BTIaUOvz.js";import{r as y,o as w}from"./index-DZzV7CRt.js";function S(n){const{isLoading:a,error:o,execute:s}=e(async(e,a)=>{const o=parseFloat(e);if(Number.isNaN(o)||o<=0)throw new Error("Invalid amount: must be a positive number");const s=await t();return s.payments.payGASAndInvoke?await s.payments.payGASAndInvoke(n,e,a):await s.payments.payGAS(n,e,a)});return{isLoading:a,error:o,payGAS:s}}function _(n){const a=e(async(e,a,o)=>{if(!e||"string"!=typeof e)throw new Error("Invalid proposalId: must be a non-empty string");const s=parseFloat(a);if(Number.isNaN(s)||s<=0)throw new Error("Invalid amount: must be a positive number");const r=await t();return await r.governance.vote(n,e,a,o)}),o=e(async()=>{const e=await t();return await e.governance.getCandidates()});return{isVoting:a.isLoading,voteError:a.error,vote:a.execute,isLoadingCandidates:o.isLoading,candidatesError:o.error,getCandidates:o.execute}}function b(n){if(!n||"string"!=typeof n)throw new Error("useRNG: appId is required and must be a non-empty string");const{isLoading:a,error:o,execute:s}=e(async()=>{const e=await t();return await e.rng.requestRandom(n)});return{isLoading:a,error:o,requestRandom:s}}function M(){const n=e(async(e={})=>{var n;const a=await t();if(!(null==(n=a.events)?void 0:n.list))throw new Error("events.list not available");return await a.events.list(e)}),a=e(async(e,n)=>{var a;const o=String(e||"").trim();if(!o)throw new Error("eventName required");const s=await t();if(!(null==(a=s.events)?void 0:a.emit))throw new Error("events.emit not available");return await s.events.emit(o,n||{})});return{isLoading:n.isLoading,error:n.error,list:n.execute,isEmitting:a.isLoading,emitError:a.error,emit:a.execute}}function k(){const t=e(async()=>n("/gas-sponsor-check")),o=e(async e=>{const t=parseFloat(e);if(Number.isNaN(t)||t<=0)throw new Error("Invalid amount: must be a positive number");return a("/gas-sponsor-request",{amount:e})});return{isCheckingEligibility:t.isLoading,eligibilityError:t.error,checkEligibility:t.execute,isRequestingSponsorship:o.isLoading,sponsorshipError:o.error,requestSponsorship:o.execute}}function D(e={}){const{slot:a="default",autoLoad:r=!1}=e,i=y([]),c=y(null),l=y(!1),d=y(!1),u=y(!1),m=y(null),p=y(null),g=async e=>{var s;l.value=!0,m.value=null;try{const o=await t(),r=(null==(s=o.getConfig)?void 0:s.call(o).appId)||"unknown",l=await n(`/api/miniapps/${r}/cloud-saves`);i.value=(null==l?void 0:l.saves)||[];const d=e||a;return c.value=i.value.find(e=>e.slot_name===d)||null,p.value=new Date,c.value}catch(r){return m.value=o(r),null}finally{l.value=!1}};return w(()=>{r&&g()}),{saves:i,currentSave:c,isLoading:l,isSaving:d,isDeleting:u,error:m,lastSyncedAt:p,load:g,save:async(e,n)=>{var r;d.value=!0,m.value=null;try{const o=await t(),i=(null==(r=o.getConfig)?void 0:r.call(o).appId)||"unknown",l=await s(`/api/miniapps/${i}/cloud-saves`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slot_name:n||a,save_data:e,client_timestamp:(new Date).toISOString()})});return c.value=l.save,p.value=new Date,!0}catch(i){return m.value=o(i),!1}finally{d.value=!1}},deleteSave:async e=>{var n,r;u.value=!0,m.value=null;try{const o=await t(),l=(null==(n=o.getConfig)?void 0:n.call(o).appId)||"unknown";return await s(`/api/miniapps/${l}/cloud-saves`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({slot_name:e||a})}),i.value=i.value.filter(t=>t.slot_name!==(e||a)),(null==(r=c.value)?void 0:r.slot_name)===(e||a)&&(c.value=null),!0}catch(l){return m.value=o(l),!1}finally{u.value=!1}}}}const I=()=>`mock-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,x={invoke:async(e,...t)=>(console.log("[MockSDK] invoke:",e,t),{}),getConfig:()=>({appId:"mock-app",contractAddress:null,debug:!0}),wallet:{getAddress:async()=>(console.log("[MockSDK] getAddress called"),"NXV7ZhHiyM1aHXwpVsRZC6BwNFP2jghXAq"),async switchChain(e){console.log("[MockSDK] switchChain called:",e)},async signMessage(e){return console.log("[MockSDK] signMessage:",e),`mock-signature-${(t=e,"function"==typeof btoa?btoa(t):"undefined"!=typeof Buffer?Buffer.from(t,"utf8").toString("base64"):t).slice(0,12)}`;var t},invokeIntent:async e=>(console.log("[MockSDK] invokeIntent:",e),{txid:I()})},payments:{async payGAS(e,t,n){console.log("[MockSDK] payGAS:",{appId:e,amount:t,memo:n}),await new Promise(e=>setTimeout(e,800));const a=I();return{request_id:a,receipt_id:a,user_id:"mock-user",intent:"payments",constraints:{settlement:"GAS_ONLY"},chain_id:"neo-n3-mainnet",chain_type:"neo-n3",invocation:{chain_id:"neo-n3-mainnet",chain_type:"neo-n3",contract_address:"0x0bb8f09e6d3611bc5c8adbd79ff8af1e34f73193",method:"transfer",params:[t,n??""]}}},async payGASAndInvoke(e,t,n){return{...await this.payGAS(e,t,n),txid:I()}}},governance:{vote:async(e,t,n,a)=>(console.log("[MockSDK] vote:",{appId:e,proposalId:t,amount:n,support:a}),await new Promise(e=>setTimeout(e,800)),{request_id:I(),user_id:"mock-user",intent:"governance",constraints:{governance:"BNEO_ONLY"},chain_id:"neo-n3-mainnet",chain_type:"neo-n3",invocation:{chain_id:"neo-n3-mainnet",chain_type:"neo-n3",contract_address:"0xc8f3bbe1c205c932aab00b28f7df99f9bc788a05",method:"vote",params:[t,n,a]}}),async voteAndInvoke(e,t,n,a){return{...await this.vote(e,t,n,a),txid:I()}},getCandidates:async()=>(console.log("[MockSDK] getCandidates called"),await new Promise(e=>setTimeout(e,500)),{candidates:[{address:"NNShaEBGVBfmGWzGs6W5sCneKPBwmCA3Br",publicKey:"02a1",name:"NeoEconoLabs",votes:"5000000",active:!0},{address:"NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",publicKey:"03b2",name:"COZ",votes:"4500000",active:!0},{address:"NKuyBkoGdZZSLyPbJEetheRhMjeznFZszf",publicKey:"02c3",name:"AxLabs",votes:"3200000",active:!0}],totalVotes:"12700000",blockHeight:1234567})},rng:{async requestRandom(e){console.log("[MockSDK] requestRandom:",e),await new Promise(e=>setTimeout(e,500));const t=Array.from({length:32},()=>Math.floor(256*Math.random()).toString(16).padStart(2,"0")).join("");return{request_id:I(),app_id:e,chain_id:"neo-n3-mainnet",chain_type:"neo-n3",randomness:t}}},datafeed:{async getPrice(e){console.log("[MockSDK] getPrice:",e);return{feed_id:I(),pair:e,price:{"NEO-USD":"12.45","GAS-USD":"4.32","BTC-USD":"43250.00","ETH-USD":"2280.50"}[e]||"100.00",decimals:8,timestamp:(new Date).toISOString(),sources:["mock"]}},getPrices:async()=>(console.log("[MockSDK] getPrices called"),{neo:{usd:12.45,usd_24h_change:1.2},gas:{usd:4.32,usd_24h_change:-.4},timestamp:Date.now()}),getNetworkStats:async()=>(console.log("[MockSDK] getNetworkStats called"),{blockHeight:1234567,validatorCount:7,network:"neo-n3-mainnet",version:"mock-1.0"}),async getRecentTransactions(e=10){console.log("[MockSDK] getRecentTransactions called:",e);const t=Math.max(1,Math.min(e,5));return{blockHeight:1234567,transactions:Array.from({length:t},()=>({txid:I(),blockHeight:1234567,blockTime:Date.now(),sender:"NQiQvS9s5XbPpKXt9g6z4yUaqE8h4PGnRy",size:123,sysfee:"0.1",netfee:"0.01"}))}}},events:{async list(e={}){console.log("[MockSDK] events.list:",e),await new Promise(e=>setTimeout(e,300));const t=I();return{events:[{id:t,app_id:e.app_id||"mock-app",event_name:e.event_name||"MockEvent",chain_id:e.chain_id||"neo-n3-mainnet",contract_address:"0x0000000000000000000000000000000000000000",tx_hash:`0x${I()}`,block_index:1234567,state:[],created_at:(new Date).toISOString()}],has_more:!1,last_id:t}}},transactions:{async list(e={}){console.log("[MockSDK] transactions.list:",e),await new Promise(e=>setTimeout(e,300));const t=I();return{transactions:[{id:t,tx_hash:`0x${t}`,request_id:I(),from_service:"mock",tx_type:"contract",chain_id:e.chain_id||"neo-n3-mainnet",contract_address:"0x0000000000000000000000000000000000000000",method_name:"transfer",params:{},gas_consumed:.1,status:"confirmed",retry_count:0,error_message:null,rpc_endpoint:null,submitted_at:(new Date).toISOString(),confirmed_at:(new Date).toISOString()}],has_more:!1,last_id:t}}},stats:{getMyUsage:async(e,t)=>(console.log("[MockSDK] stats.getMyUsage:",{appId:e,date:t}),await new Promise(e=>setTimeout(e,300)),{app_id:e,chain_id:"neo-n3-mainnet",date:t||(new Date).toISOString().split("T")[0],transactions:42,volume_gas:"123.45",unique_users:10})}};function A(){"undefined"!=typeof window&&(window.MiniAppSDK=x,console.log("[MockSDK] Installed on window.MiniAppSDK"),window.dispatchEvent(new Event("miniapp-sdk-ready")))}function E(){const e=Date.now()+36e5+72e5*Math.random();return{type:"live_countdown",refreshInterval:1,endTime:Math.floor(e/1e3),jackpot:(1e3+9e3*Math.random()).toFixed(2),ticketsSold:Math.floor(100+500*Math.random()),ticketPrice:"0.1"}}function N(){return{type:"live_multiplier",refreshInterval:.1,currentMultiplier:1+5*Math.random(),status:["waiting","running","crashed"][Math.floor(3*Math.random())],playersCount:Math.floor(10+50*Math.random()),totalBets:(100+900*Math.random()).toFixed(2)}}function K(){return{type:"live_canvas",refreshInterval:5,pixels:L(32,32),width:32,height:32,activeUsers:Math.floor(5+20*Math.random())}}function L(e,t){const n=["#10b981","#3b82f6","#ec4899","#f59e0b","#8b5cf6"];let a="";for(let o=0;o<e*t;o++)a+=n[Math.floor(Math.random()*n.length)].slice(1);return a}function C(){return{type:"live_stats",refreshInterval:10,stats:[{label:"Available",value:String(Math.floor(5+20*Math.random())),icon:"ðŸ§§"},{label:"Total GAS",value:(50+200*Math.random()).toFixed(1),change:12.5},{label:"Claimed",value:String(Math.floor(100+500*Math.random()))}]}}function T(){const e=Math.floor(1e3+5e3*Math.random()),t=Math.floor(e*(.3+.5*Math.random()));return{type:"live_voting",refreshInterval:30,proposalTitle:"Increase staking rewards",yesVotes:t,noVotes:e-t,totalVotes:e,endTime:Math.floor((Date.now()+2592e5)/1e3)}}function P(){const e=10+5*Math.random();return{type:"live_price",refreshInterval:5,symbol:"NEO-USD",price:e.toFixed(2),change24h:10*Math.random()-5,sparkline:Array.from({length:24},()=>e*(.95+.1*Math.random()))}}function G(){const e=new AbortController;return{signal:e.signal,cancel:()=>e.abort(),isCancelled:()=>e.signal.aborted}}class q{constructor(){this.controllers=new Map}create(e){this.cancel(e);const t=new AbortController;return this.controllers.set(e,t),t.signal}cancel(e){const t=this.controllers.get(e);t&&(t.abort(),this.controllers.delete(e))}cancelAll(){for(const e of this.controllers.values())e.abort();this.controllers.clear()}isPending(e){const t=this.controllers.get(e);return!!t&&!t.signal.aborted}}const O=new q;export{q as RequestManager,s as apiFetch,n as apiGet,a as apiPost,r as callBridge,i as cleanupWalletStateListener,G as createCancellableRequest,c as createH5Bridge,l as getSDKSync,d as getWalletState,u as initWalletStateListener,A as installMockSDK,K as mockCanvasData,E as mockCountdownData,N as mockMultiplierData,P as mockPriceData,x as mockSDK,C as mockStatsData,T as mockVotingData,O as requestManager,m as resetI18nState,p as resolveLayout,g as subscribeToWalletState,e as useAsyncAction,D as useCloudSaves,v as useDatafeed,M as useEvents,k as useGasSponsor,_ as useGovernance,h as useI18n,S as usePayments,b as useRNG,f as useWallet,t as waitForSDK};

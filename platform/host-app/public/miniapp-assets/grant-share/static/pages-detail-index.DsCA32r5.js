import{A as e,z as a,O as t,B as s,d as l,a as i,C as n,r as o,f as c,w as u,u as r,e as d,g as _,i as v,j as f,t as p,h as m,n as g,k as h,D as b}from"./index-D7vKygKI.js";import{u as y,_ as k}from"./NeoDoc.vue_vue_type_style_index_0_scoped_445ca862_lang.Dm8xFBU8.js";import{N as x,b as A,_ as j}from"./Fireworks.vue_vue_type_style_index_0_scoped_4da74fd1_lang.BPD2k7sd.js";const C=(t=>(l,i=a())=>{!s&&e(t,l,i)})(t),S=k(l({__name:"index",setup(e){const{t:a,locale:t}=y(),s=i(""),l=i(!0),k=i(!1),S=i(null);function w(){b()}function D(e){try{return decodeURIComponent(escape(atob(e)))}catch{return e}}function N(e){return String(e||"").toLowerCase()}function U(e){return Number.isFinite(e)?e.toLocaleString():"0"}function I(e){if(!e)return"";const a=new Date(e);if(Number.isNaN(a.getTime()))return"";const s="zh"===t.value?"zh-CN":"en-US";return a.toLocaleDateString(s,{month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}return i(""),C(e=>{if(e&&e.id){s.value=e.id;try{const a=n("current_grant_detail");if(a&&String(a.id)===String(e.id))return S.value=a,void(l.value=!1)}catch(a){}!async function(e){l.value=!0,k.value=!1;try{const a=await new Promise((a,t)=>{o({url:`/api/grantshares/proposal?id=${e}`,success:e=>a(e.data),fail:e=>t(e)})});if(a){const e=a;S.value={id:String(e.offchain_id||e.id||""),title:D(e.title||""),description:D(e.description||""),proposer:String(e.proposer||e.proposer_address||e.proposerAddress||""),state:N(e.state||""),votesAccept:Number(e.votes_amount_accept||e.votesAmountAccept||0),votesReject:Number(e.votes_amount_reject||e.votesAmountReject||0),discussionUrl:String(e.discussion_url||e.discussionUrl||""),createdAt:String(e.offchain_creation_timestamp||e.offchainCreationTimestamp||""),onchainId:e.onchain_id??e.onchainId??null}}else k.value=!0}catch(a){k.value=!0}finally{l.value=!1}}(e.id)}else k.value=!0,l.value=!1}),(e,t)=>{const s=v,i=m;return d(),c(r(j),{"desktop-breakpoint":1024,class:"theme-grant-share"},{default:u(()=>[_(s,{class:"app-container"},{default:u(()=>[_(s,{class:"nav-header mb-4"},{default:u(()=>[_(r(x),{size:"sm",variant:"secondary",onClick:w},{default:u(()=>[f(" â† "+p(r(a)("back")),1)]),_:1})]),_:1}),l.value?(d(),c(s,{key:0,class:"empty-state"},{default:u(()=>[_(i,{class:"empty-text"},{default:u(()=>[f(p(r(a)("loading")),1)]),_:1})]),_:1})):k.value?(d(),c(s,{key:1,class:"empty-state"},{default:u(()=>[_(i,{class:"empty-text"},{default:u(()=>[f(p(r(a)("loadFailed")),1)]),_:1})]),_:1})):S.value?(d(),c(s,{key:2,class:"grant-detail"},{default:u(()=>[_(r(A),{variant:"erobo-neo",class:"mb-4"},{default:u(()=>[_(s,{class:"header-section"},{default:u(()=>[_(i,{class:"grant-title-glass"},{default:u(()=>[f(p(S.value.title),1)]),_:1}),_(s,{class:"meta-row mt-2"},{default:u(()=>[_(i,{class:"grant-creator-glass"},{default:u(()=>[f(p(r(a)("by"))+" "+p(S.value.proposer),1)]),_:1}),_(s,{class:g(["grant-badge-glass",S.value.state])},{default:u(()=>[_(i,{class:"badge-text"},{default:u(()=>{return[f(p((e=S.value.state,{active:a("statusActive"),review:a("statusReview"),voting:a("statusVoting"),discussion:a("statusDiscussion"),executed:a("statusExecuted"),cancelled:a("statusCancelled"),rejected:a("statusRejected"),expired:a("statusExpired")}[N(e)]||e)),1)];var e}),_:1})]),_:1},8,["class"])]),_:1}),_(s,{class:"proposal-meta mt-2"},{default:u(()=>[null!==S.value.onchainId?(d(),c(i,{key:0,class:"meta-item"},{default:u(()=>[f("#"+p(S.value.onchainId),1)]),_:1})):h("",!0),S.value.createdAt?(d(),c(i,{key:1,class:"meta-item"},{default:u(()=>[f(p(I(S.value.createdAt)),1)]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1}),_(r(A),{variant:"erobo-neo",class:"mb-4"},{default:u(()=>[_(s,{class:"section-title-glass"},{default:u(()=>[f(p(r(a)("details")),1)]),_:1}),_(s,{class:"description-content"},{default:u(()=>[_(i,{class:"desc-text"},{default:u(()=>[f(p(S.value.description||r(a)("noDescription")),1)]),_:1})]),_:1})]),_:1}),_(r(A),{variant:"erobo-neo",class:"mb-4"},{default:u(()=>[_(s,{class:"section-title-glass"},{default:u(()=>[f(p(r(a)("voting")),1)]),_:1}),_(s,{class:"proposal-stats"},{default:u(()=>[_(s,{class:"stat-chip accept"},{default:u(()=>[f(p(r(a)("votesFor"))+" "+p(U(S.value.votesAccept)),1)]),_:1}),_(s,{class:"stat-chip reject"},{default:u(()=>[f(p(r(a)("votesAgainst"))+" "+p(U(S.value.votesReject)),1)]),_:1})]),_:1}),_(s,{class:"mt-4 flex gap-2"},{default:u(()=>[_(r(x),{size:"sm",variant:"secondary",disabled:!S.value.discussionUrl,onClick:t[0]||(t[0]=e=>function(e){if(!e)return;const t=null==globalThis?void 0:globalThis.uni;(null==t?void 0:t.setClipboardData)&&t.setClipboardData({data:e,success:()=>{a("linkCopied")},fail:()=>{a("copyFailed")}})}(S.value.discussionUrl))},{default:u(()=>[f(p(S.value.discussionUrl?r(a)("discussionLink"):r(a)("noDiscussion")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-19840d82"]]);export{S as default};

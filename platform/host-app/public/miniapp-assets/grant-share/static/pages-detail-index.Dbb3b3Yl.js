import{E as e,D as t,O as a,G as s,d as i,a as n,H as o,r,f as c,w as l,u,e as d,g as f,i as p,j as _,t as m,h as v,n as g,k as h,I as b}from"./index-B0A-WPaa.js";import{u as y,_ as j}from"./NeoDoc.vue_vue_type_style_index_0_scoped_b60f38ea_lang.Csip7zAd.js";import{u as k,N as w,b as x,_ as N}from"./useStatusMessage.D9H6W3Au.js";const S=(a=>(i,n=t())=>{!s&&e(a,i,n)})(a),C=j(i({__name:"index",setup(e){const{t:t,locale:a}=y(),s=n(""),i=n(!0),j=n(!1),C=n(null),{setStatus:A}=k(),D="undefined"!=typeof window&&["127.0.0.1","localhost"].includes(window.location.hostname),R={items:[{offchain_id:"101",title:"Developer Education Sprint",description:"Build a 6-week education sprint focused on secure NEO smart contract development.",proposer:"NfYhP6Yw5tM4oX2Qz7bR5mU8dC6jK9vW1Q",state:"active",votes_amount_accept:152340,votes_amount_reject:12340,discussion_url:"https://forum.grantshares.io/t/dev-education-sprint",offchain_creation_timestamp:"2026-01-30T08:12:00.000Z",onchain_id:57},{offchain_id:"102",title:"Neo Wallet UX Research",description:"Research and prototype better onboarding and transaction clarity for first-time users.",proposer:"NQf1fY3mP8jC2rL7nD4sX9aV6kW3mP5tYH",state:"review",votes_amount_accept:92340,votes_amount_reject:4560,discussion_url:"https://forum.grantshares.io/t/wallet-ux-research",offchain_creation_timestamp:"2026-02-01T13:20:00.000Z",onchain_id:58},{offchain_id:"103",title:"Cross-Chain Tooling Maintenance",description:"Maintain bridge and indexing tooling to improve reliability and incident response.",proposer:"NdR6mX4tW8qL2dP5sH9fV3bN1kJ7gC2qZT",state:"executed",votes_amount_accept:210340,votes_amount_reject:7830,discussion_url:"https://forum.grantshares.io/t/cross-chain-tooling-maintenance",offchain_creation_timestamp:"2025-12-18T10:45:00.000Z",onchain_id:54}]};function T(){b()}function U(e){try{return decodeURIComponent(escape(atob(e)))}catch{return e}}function I(e){return String(e||"").toLowerCase()}function L(e){return Number.isFinite(e)?e.toLocaleString():"0"}function z(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s="zh"===a.value?"zh-CN":"en-US";return t.toLocaleDateString(s,{month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}return S(e=>{if(e&&e.id){s.value=e.id;try{const t=o("current_grant_detail");if(t&&String(t.id)===String(e.id))return C.value=t,void(i.value=!1)}catch(t){}!async function(e){i.value=!0,j.value=!1;try{let t=null;if(D){const a=R;Array.isArray(a.items)&&(t=a.items.find(t=>String(t.offchain_id||"")===String(e))||null)}if(t||(t=await new Promise((t,a)=>{r({url:`/api/grantshares/proposal?id=${e}`,success:e=>t((e=>{if("string"==typeof e)try{return JSON.parse(e)}catch{return null}return e})(e.data)),fail:e=>a(e)})})),t){const e=t;C.value={id:String(e.offchain_id||e.id||""),title:U(e.title||""),description:U(e.description||""),proposer:String(e.proposer||e.proposer_address||e.proposerAddress||""),state:I(e.state||""),votesAccept:Number(e.votes_amount_accept||e.votesAmountAccept||0),votesReject:Number(e.votes_amount_reject||e.votesAmountReject||0),discussionUrl:String(e.discussion_url||e.discussionUrl||""),createdAt:String(e.offchain_creation_timestamp||e.offchainCreationTimestamp||""),onchainId:e.onchain_id??e.onchainId??null}}else j.value=!0}catch(t){j.value=!0}finally{i.value=!1}}(e.id)}else j.value=!0,i.value=!1}),(e,a)=>{const s=p,n=v;return d(),c(u(N),{"desktop-breakpoint":1024,class:"theme-grant-share"},{default:l(()=>[f(s,{class:"app-container"},{default:l(()=>[f(s,{class:"nav-header mb-4"},{default:l(()=>[f(u(w),{size:"sm",variant:"secondary",onClick:T},{default:l(()=>[_(" â† "+m(u(t)("back")),1)]),_:1})]),_:1}),i.value?(d(),c(s,{key:0,class:"empty-state"},{default:l(()=>[f(n,{class:"empty-text"},{default:l(()=>[_(m(u(t)("loading")),1)]),_:1})]),_:1})):j.value?(d(),c(s,{key:1,class:"empty-state"},{default:l(()=>[f(n,{class:"empty-text"},{default:l(()=>[_(m(u(t)("loadFailed")),1)]),_:1})]),_:1})):C.value?(d(),c(s,{key:2,class:"grant-detail"},{default:l(()=>[f(u(x),{variant:"erobo-neo",class:"mb-4"},{default:l(()=>[f(s,{class:"header-section"},{default:l(()=>[f(n,{class:"grant-title-glass"},{default:l(()=>[_(m(C.value.title),1)]),_:1}),f(s,{class:"meta-row mt-2"},{default:l(()=>[f(n,{class:"grant-creator-glass"},{default:l(()=>[_(m(u(t)("by"))+" "+m(C.value.proposer),1)]),_:1}),f(s,{class:g(["grant-badge-glass",C.value.state])},{default:l(()=>[f(n,{class:"badge-text"},{default:l(()=>{return[_(m((e=C.value.state,{active:t("statusActive"),review:t("statusReview"),voting:t("statusVoting"),discussion:t("statusDiscussion"),executed:t("statusExecuted"),cancelled:t("statusCancelled"),rejected:t("statusRejected"),expired:t("statusExpired")}[I(e)]||e)),1)];var e}),_:1})]),_:1},8,["class"])]),_:1}),f(s,{class:"proposal-meta mt-2"},{default:l(()=>[null!==C.value.onchainId?(d(),c(n,{key:0,class:"meta-item"},{default:l(()=>[_("#"+m(C.value.onchainId),1)]),_:1})):h("",!0),C.value.createdAt?(d(),c(n,{key:1,class:"meta-item"},{default:l(()=>[_(m(z(C.value.createdAt)),1)]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1}),f(u(x),{variant:"erobo-neo",class:"mb-4"},{default:l(()=>[f(s,{class:"section-title-glass"},{default:l(()=>[_(m(u(t)("details")),1)]),_:1}),f(s,{class:"description-content"},{default:l(()=>[f(n,{class:"desc-text"},{default:l(()=>[_(m(C.value.description||u(t)("noDescription")),1)]),_:1})]),_:1})]),_:1}),f(u(x),{variant:"erobo-neo",class:"mb-4"},{default:l(()=>[f(s,{class:"section-title-glass"},{default:l(()=>[_(m(u(t)("voting")),1)]),_:1}),f(s,{class:"proposal-stats"},{default:l(()=>[f(s,{class:"stat-chip accept"},{default:l(()=>[_(m(u(t)("votesFor"))+" "+m(L(C.value.votesAccept)),1)]),_:1}),f(s,{class:"stat-chip reject"},{default:l(()=>[_(m(u(t)("votesAgainst"))+" "+m(L(C.value.votesReject)),1)]),_:1})]),_:1}),f(s,{class:"mt-4 flex gap-2"},{default:l(()=>[f(u(w),{size:"sm",variant:"secondary",disabled:!C.value.discussionUrl,onClick:a[0]||(a[0]=e=>function(e){if(!e)return;const a=null==globalThis?void 0:globalThis.uni;(null==a?void 0:a.setClipboardData)&&a.setClipboardData({data:e,success:()=>A(t("linkCopied"),"success"),fail:()=>A(t("copyFailed"),"error")})}(C.value.discussionUrl))},{default:l(()=>[_(m(C.value.discussionUrl?u(t)("discussionLink"):u(t)("noDiscussion")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1})]),_:1})}}}),[["__scopeId","data-v-c864a3a2"]]);export{C as default};

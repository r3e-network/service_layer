# Starter config that enables automatic migrations at startup.
# Use only when you explicitly want the appserver to run migrations on boot.
#
# For production/shared environments prefer controlled rollouts via your
# migration workflow instead of enabling this flag.

server:
  host: "0.0.0.0"
  port: 8080

database:
  driver: "postgres"
  dsn: "postgres://supabase_admin:supabase_pass@localhost:5432/service_layer?sslmode=disable"
  max_open_conns: 10
  max_idle_conns: 5
  conn_max_lifetime: 300
  migrate_on_start: true

auth:
  tokens:
    - "dev-token"
  supabase_jwt_secret: "super-secret-jwt"
  supabase_jwt_aud: "authenticated"
  supabase_admin_roles: ["service_role", "admin"]
  supabase_tenant_claim: "app_metadata.tenant"
  supabase_role_claim: "app_metadata.role"
  supabase_gotrue_url: "http://supabase-gotrue:9999"
  jwt_secret: "change-me-jwt-secret"
  users:
    - username: "admin"
      password: "changeme"
      role: "admin"

runtime:
  unknown_modules_strict: true
  slow_module_threshold_ms: 1000
  random:
    # Optional base64/hex encoded ed25519 private key for deterministic random
    # signatures. Leave empty to auto-generate ephemeral keys on startup
    # (NOT recommended for production; set a persistent key to keep signatures stable).
    signing_key: ""
  pricefeed:
    fetch_url: ""
    fetch_key: ""
  gasbank:
    resolver_url: ""
    resolver_key: ""
    poll_interval: "15s"
    max_attempts: 5
  oracle:
    ttl_seconds: 0
    max_attempts: 3
    backoff: "10s"
    dlq_enabled: true
    runner_tokens: []
  datafeeds:
    min_signers: 0
    aggregation: "median"
  # Bus payload cap for /system/events|data|compute. Prefer env override BUS_MAX_BYTES.
  bus_max_bytes: 1048576
  cre:
    http_runner: false
  neo:
    enabled: false
    rpc_url: "http://localhost:10332"
    network: "testnet"
    indexer_url: "http://localhost:8080/neo/status"
  chains:
    enabled: false
    require_tenant: false
    per_tenant_per_minute: 0
    per_token_per_minute: 0
    burst: 3
    allowed_methods:
      eth: ["eth_blockNumber", "eth_getBalance"]
    endpoints:
      eth: "https://sepolia.infura.io/v3/<key>"
      btc: "https://mempool.space/testnet/api/v1/blocks"
      neox: "http://localhost:1234"
  data_sources:
    enabled: false
    sources:
      coingecko: "https://api.coingecko.com/api/v3/ping"
      example: "https://example.com/healthz"
  contracts:
    enabled: false
    network: "neo-testnet"
  crypto:
    enabled: false
    endpoint: ""
    capabilities: ["zkp", "fhe", "mpc"]
  rocketmq:
    enabled: false
    name_servers: ["127.0.0.1:9876"]
    access_key: ""
    secret_key: ""
    topic_prefix: "sl"
    consumer_group: "sl-consumers"
    namespace: ""
    max_reconsume_times: 16
    consume_batch: 1
    consume_from: "latest"
  service_bank:
    enabled: false

security:
  secret_encryption_key: ""
